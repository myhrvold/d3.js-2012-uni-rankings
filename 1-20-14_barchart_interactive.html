<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Weighted US News 2012 World University Rankings</title>    
    
    <style type= "text/css">
    body { 
        font: Verdana, 'sans-serif' !important;
        font-size: 14px !important;
        font-weight:normal ;
    }

    .x.axis path { display: none; }
    
    rect:hover{ fill:pink ; }
        
    td, th { padding: 1px 4px; }
    </style>
    
    <div align="center">   
    <h2> Interactive US News/QS 2012 World University Rankings </h2>
    <h3> Conor L. Myhrvold </h3>
    <h3> CS299r, Fall 2013, Hanspeter Pfister Lab, Harvard SEAS & IACS </h3>
    <h4> <i>Special thanks to Alexander Lex and Pavlos Protopapas</i> </h4>
    </div>
  
    <p> 
    <!-- for padding style: http://www.plus2net.com/html_tutorial/html_blank_space.php -->
    <span style="padding-left:185px">
  	<!-- Twitter follow button start -->
	<a href="http://twitter.com/conormyhrvold" class="twitter-follow-button">Follow @conormyhrvold</a>
	<script>!function(d,s,id){
            var js,fjs=d.getElementsByTagName(s)[0];
            if(!d.getElementById(id)){js=d.createElement(s);
            js.id=id;
            js.src="//platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
    </script>
	<!-- Twitter follow button end -->
    </span>
    </p>
   
    <p>   
    <form name = "form_weight1" id = "form_weight1" >
    <!-- http://webtutsdepot.com/2010/04/24/html-5-slider-input-tutorial/ , 
    http://stackoverflow.com/questions/20781635/displaying-values-from-multiple-javascript-slider-values/20789860?noredirect=1#20789860 -->
    <span style="padding-left:185px">
    <text><b> Academic Reputation Score </b></text>
    </span>
    <span style="padding-left:8px">
    <input id="weight1" input type="range" name="weight1" min="0" max="100" value="40" step="1" onchange="showValue(this); newWeights();" />
    <span id="range">40</span>
    </span>
    <script type="text/javascript">
    <!-- JavaScript bin that modified code: http://jsbin.com/ISekuSiN/5/edit  -->
    function get_nextsibling(n) {
        x=n.nextSibling;
     while (x.nodeType!=1) {
        x=x.nextSibling; }
     return x; }
     
    function showValue(self) {
        get_nextsibling(self).innerHTML=self.value; }
    </script>
    </form>
    <form name = "form_weight2" id = "form_weight2" >
        <span style="padding-left:185px">
        <text><b> Employer Reputation Score </b></text>
        </span>
        <span style="padding-left:10px">
        <input id="weight2" input type="range" name="weight2" min="0" max="100" value="10" step="1" onchange="showValue(this); newWeights();" />
        <span id="range">10</span>
        </span>
    </form>
    <form name = "form_weight3" id = "form_weight3" >
        <span style="padding-left:185px">
        <text><b> Faculty-Student Ratio Score </b></text>
        </span>
        <span style="padding-left:5px">        
        <input id="weight3" input type="range" name="weight3" min="0" max="100" value="20" step="1" onchange="showValue(this); newWeights();" />
        <span id="range">20</span>
        <span>
    </form>
    <form name = "form_weight4" id = "form_weight4" >
        <span style="padding-left:185px">
        <text><b> International Faculty Score </b></text> 
        </span>
        <span style="padding-left:9px">
        <input id="weight4" input type="range" name="weight4" min="0" max="100" value="5" step="1" onchange="showValue(this); newWeights();" />
        <span id="range">5</span>
        </span>
    </form>
    <form name = "form_weight5" id = "form_weight5" >
        <span style="padding-left:185px">
        <text><b> International Student Score </b></text>
        </span>
        <span style="padding-left:7px">        
        <input id="weight5" input type="range" name="weight5" min="0" max="100" value="5" step="1" onchange="showValue(this); newWeights();" />
        <span id="range">5</span>
        </span>
    </form>
    <form name = "form_weight6" id = "form_weight6" >
        <span style="padding-left:185px">
        <text><b> Faculty Citation Score </b></text>
        </span>
        <span style="padding-left:39px">        
        <input id="weight6" input type="range" name="weight6" min="0" max="100" value="20" step="1" onchange="showValue(this); newWeights();" />
        <span id="range">20</span>
        <!--<text>/ %</text> -->
        </span>
    </form>
    </p> 

    <!-- Refresh button -- see below for source -->
    <script type="text/javascript">
    <!-- This script and many more are available free online at -->
    <!-- The JavaScript Source!! http://www.javascriptsource.com -->
    <!-- Original:  Happy Smart -->
    <!-- Web Site:  http://happysmart.net -->
    document.write('<form><input type=button value="Refresh (or hit F5)" style="position: absolute; left: 190px;" onClick="history.go()"></form>') <!-- Goes to default weighted score view by refreshing page -->
    //  End -->
    </script>

    <script type="text/javascript" src="d3.v3.js"></script>
    
    <div id="option">
    <input name="updateButton" 
            type="button" 
            value="US News/QS Rankings"
            style="position: absolute; left: 190px; bottom: 270px;"
            onclick="originalWeightedScore()" />
    </div>

    <div id="option">
    <input name="sortButton" 
            type="button" 
            value="Sort" 
            style="position: absolute; left: 350px; bottom: 270px;"
            onclick="sort_orig()" />
    </div>    

    <div id="option2">
    <input name="scaleButton" 
            type="button" 
            value="Unscale Scores" 
            style="position: absolute; left: 920px; bottom: 290px;"
            onclick="unscale_scenario()" />
    </div>   

    <div id="option3">
    <input name="separateButton" 
            type="button" 
            value="Separate Scores"
            style="position: absolute; left: 920px; bottom: 250px;"
            onclick="separateScores()" />
    </div>   

    <div id="option4">
    <input name="stackButton" 
            type="button" 
            value="Stack Scores" 
            style="position: absolute; left: 920px; bottom: 270px;"
            onclick="stackChoose()" />
    </div>    
    <br></br>
    <p><center>
    <div id="chart"></div>   
    </p>
</head>
<body>
    <p><center>
    <script type="text/javascript">     
    // ----------------------------------- Declare variables --------------------------------------
    //Globally defined variables
    var barHeight = 20 ; // height of one bar   
    var uniLabel = 550 ; // space reserved for bar labels of universities
    var finalScoreNumberWidth = 50 ; // space reserved for value labels (right)
    var barLabelPadding = 5 ; // padding between bar and bar labels (left)
    var gridLabelHeight = 30 ; // space reserved for gridline labels
    var topMargin = 5 ; // space from top where chart starts
    var totalWidth = 500 ;       
    var maxFinalScoreBarWidth = totalWidth/2 ; // width of the bar with the max value
    var otherBarsNumber = 6 ;
    var maxOtherBarWidth = totalWidth - maxFinalScoreBarWidth  ;           
    var ranklist = d3.range(400) ; // list of numbers from 1 to 400 to display on chart (had a more complicated Javascript loop before...)

    var init_score_display_offset = 3; // score display offset for academic reputation score to not overlap
    var global_display_offset = 4 ; //offset in between rects to ensure that none overlap
    
    var xoffset = -80 ; 
    //negative number shifts to left. moves graph to the left so that there's more space for spreading out score components.
    
    var weightfactor1 ; // declare weight factors
    var weightfactor2 ;
    var weightfactor3 ;
    var weightfactor4 ; 
    var weightfactor5 ;
    var weightfactor6 ;
    
    //Function-dependent variables. See http://stackoverflow.com/questions/10608964/how-to-share-scope-between-functions-in-d3-js . It's suggested method.
    var weight1 ;
    var weight2 ;
    var weight3 ;
    var weight4 ;    
    var weight5 ;
    var weight6 ;
    
    var orig_weight1 ;
    var orig_weight2 ;
    var orig_weight3 ;
    var orig_weight4 ;    
    var orig_weight5 ;
    var orig_weight6 ;    
    
    var dataset ;
    var barLabel ;
    var barLabel2 ;
    var barLabel3 ;
    
    var overallScore ;
    var academicReputationScore ;
    var employerReputationScore ;
    var facultyStudentRatioScore ;
    var internationalFacultyScore ;
    var internationalStudentScore ;
    var citationsPerFacultyScore ;
    
    var orig_academicReputationScore ;
    var orig_employerReputationScore ;
    var orig_facultyStudentRatioScore ;
    var orig_internationalFacultyScore ;
    var orig_internationalStudentScore ;
    var orig_citationsPerFacultyScore ;
    
    var weightedScore ;
    var sortedData ;
    var yScale ;
    var x ;
    var y ;
    var svg_width ;
    var svg_height ;
    var yText ;
    var chart ;
    
    var labelsContainer ;
    var weightedScoreContainer ;
    var rankContainer ;
    var x2 ;
    var academicRepScoreContainer ;
    var x3 ;
    var employerRepScoreContainer ;
    var x4 ;
    var facStuRatioScoreContainer ;
    var x5 ;
    var intFacScoreContainer ;
    var x6 ;
    var intStuScoreContainer ;
    var x7 ;
    var citationScoreContainer ;   
    
    //standardize x attributes for spacing the score component bars ( spaced vs not spaced, fixed width vs weighted width)
    var x_attr2 ;
    var x_attr3 ;
    var x_attr4 ;
    var x_attr5 ;
    var x_attr6 ;
    var x_attr7 ;  
    
    //for separate scores function & other functions
    var addWidth ;
    var unscale_button_count ;
    var separate_button_count ;
    var addBarSpace ;  
    var original_scores_button ; // 0 if it's weighted -- 1 if it's orignal -- 2 if it's new weighted
    
    //new weights
    var weight_factor_sum ;
    var new_weight1 ;
    var new_weight2 ;
    var new_weight3 ;
    var new_weight4 ;
    var new_weight5 ;
    var new_weight6 ;
    var new_academicReputationScore ;
    var new_employerReputationScore ;
    var new_facultyStudentRatioScore ;
    var new_internationalFacultyScore ;
    var new_internationalStudentScore ;
    var new_citationsPerFacultyScore ;
    var new_weightedScore ;
    
    var base_offset ; //declare variable for a baseline offset that I'll use and define differently for below functions
    
    var stack_score_button = 0 ; 
    //this is just for the New Weights. If you have more than 1 slider set to > 0, but some zero, when you try to add sliders AFTER you've stacked the new
    //one won't show. So in that case, you have to refresh. 
 
    //Original weights used by QS Rankings 2012
    function startWeights() {
        weight1 = 0.4 ; // AcademicReputationScore
        weight2 = 0.1; // EmployerReputationScore
        weight3 = 0.2 ; // FacultyStudentRatioScore
        weight4 = 0.05 ; //InternationalFacultyScore
        weight5 = 0.05  ; //InternationalStudentsScore 
        weight6 = 0.2  ; //CitationsperFacultyScore  
    }
    
    function origWeights() {
        orig_weight1 = 0.4 ; // AcademicReputationScore
        orig_weight2 = 0.1 ; // EmployerReputationScore
        orig_weight3 = 0.2 ; // FacultyStudentRatioScore
        orig_weight4 = 0.05 ; //InternationalFacultyScore
        orig_weight5 = 0.05 ; //InternationalStudentsScore 
        orig_weight6 = 0.2 ; //CitationsperFacultyScore            
    }   
    
    // ----------------------------------- Now start functions to generate charts --------------------------------------

    function makeChart() {

        dataset = d3.csv.parse(d3.select('#csv').text());
        
        // Rank,School,Country
        barLabel = function(d) { return d['School']+' '+','+' '+d['Country']; } ;
        barLabel2 = function(d) { return d['Country']; } ;
        barLabel3 = function(d) { return d['Rank']; } ;
                    
        // OverallScore,AcademicReputationScore,EmployerReputationScore,FacultyStudentRatioScore,InternationalFacultyScore,InternationalStudentsScore,CitationsperFacultyScore        
        overallScore = function(d) { return parseFloat(d['OverallScore']); } ; //this remains unchanged since it's the original
        academicReputationScore = function(d) { return parseFloat(weight1*d['AcademicReputationScore']); } ; //now make function that multiply by weights...use to build rects
        employerReputationScore = function(d) { return parseFloat(weight2*d['EmployerReputationScore']); } ;
        facultyStudentRatioScore = function(d) { return parseFloat(weight3*d['FacultyStudentRatioScore']); } ;
        internationalFacultyScore = function(d) { return parseFloat(weight4*d['InternationalFacultyScore']); } ;
        internationalStudentScore = function(d) { return parseFloat(weight5*d['InternationalStudentsScore']); } ;
        citationsPerFacultyScore = function(d) { return parseFloat(weight6*d['CitationsperFacultyScore']); } ;
        
        weightedScore = function(d) { return parseFloat(weight1*d['AcademicReputationScore'])+parseFloat(weight2*d['EmployerReputationScore'])
                                            +parseFloat(weight3*d['FacultyStudentRatioScore'])+parseFloat(weight4*d['InternationalFacultyScore'])
                                            +parseFloat(weight5*d['InternationalStudentsScore']+parseFloat(weight6*d['CitationsperFacultyScore'])); } ;
                
        sortedData = dataset.sort(function(a, b) {return d3.descending(weightedScore(a), weightedScore(b));});

        //Scales
        yScale = d3.scale.ordinal().domain(d3.range(0, sortedData.length))
                                   .rangeBands([0, sortedData.length * barHeight]);
        
        x = d3.scale.linear().domain([0, d3.max(sortedData, weightedScore)])
                             .range([0, maxFinalScoreBarWidth]);
        
        y = function(d, i) { return yScale(i); };
        
        yText = function(d, i) { return y(d, i) + yScale.rangeBand() / 2; }; // the /2 centers text to middle of bar height (which is middle of bar)
                
        //SVG Container Element
        svg_width = totalWidth + uniLabel + finalScoreNumberWidth ;
        svg_height = gridLabelHeight + topMargin + sortedData.length * barHeight ;
        chart = d3.select('#chart').append("svg")
                                   .attr('width', svg_width) //set to accommodate additional bars I'll build
                                   .attr('height', svg_height);
        
        // University Names
        labelsContainer = chart.append('g')
                               .attr("class", "university-labels-container") //create labels so can be updated
                               .attr('transform', 'translate(' + (uniLabel - barLabelPadding) + ',' + (gridLabelHeight + topMargin) + ')') 
                               .selectAll('text')
                               .data(sortedData)
                               .enter()
                               .append('text')                             
                               .attr('x', xoffset)
                               .attr('y', yText)
                               .attr('stroke', 'none')
                               .attr('fill', 'black')
                               .attr("dy", ".35em") // vertical-align: middle
                               .attr('text-anchor', 'end')
                               .text(barLabel);
                 
        // Overall Score Bars
        weightedScoreContainer = chart.append('g')
                                 .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')'); 
                             
        weightedScoreContainer.selectAll("rect")
                              .data(sortedData)
                              .enter()
                              .append("rect")
                              .attr('x', xoffset)
                              .attr('y', y)
                              .attr('height', yScale.rangeBand())
                              .attr('width', function(d) { return x(weightedScore(d)); })
                              .attr('stroke', 'black')
                              .attr('fill', '#4985D6') //blue   http://www.hitmill.com/html/pastels.html
                              .on("click", function(d) { console.log(d) ;})
                              .append("title")
                              .text(function(d){ return "Overall Weighted Score: " + d3.round(weightedScore(d), 1); }) ;
                                      
        // Bar Value Labels
        weightedScoreContainer.selectAll("text")
                              .data(sortedData)
                              .enter()
                              .append("text")
                              .attr("x", function(d) { return x(weightedScore(d))+xoffset; })
                              .attr("y", yText)
                              .attr("dx", -25) // padding for bar value labels
                              .attr("dy", ".3em") // vertical-align: middle
                              .attr("text-anchor", "right") // text-align: right
                              .attr("fill", "white")
                              .style("font-weight", "bold") 
                              .text(function(d) { return d3.round(weightedScore(d), 0); });

        //static rankings to appear on left hand side (will always stay there)            
        rankContainer = chart.append('g')
                             .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');     
                             
        rankContainer.selectAll("rect")
                     .data(sortedData)
                     .enter()
                     .append("rect")
                     .attr('x', -550)
                     .attr('y', y)
                     .attr('height', yScale.rangeBand())
                     .attr('width', function(d) { return 30; })
                     .attr('stroke', 'black')
                     .attr('fill', 'white')
                     .append("title")
                     .text("Overall Rank") ;

        rankContainer.selectAll("text")
                     .data(ranklist)
                     .enter()
                     .append("text")
                     .attr("x", function(d) { return 15;})
                     .attr("y", function(d, i) { return y(d, i) + yScale.rangeBand() /4 ; })
                     .attr("dx", -550) // padding for bar value labels
                     .attr("dy", ".6em") // vertical-align
                     .attr("text-anchor", "middle") // text-align
                     .attr("fill", "black")
                     .text(function(d) { return ranklist[d]+1 ; }) ;                                              
                         
        x2 = d3.scale.linear().domain([0, d3.max(sortedData, academicReputationScore)])
                              .range([0, parseInt(weight1*maxOtherBarWidth)]);   
        
        x_attr2 =  maxFinalScoreBarWidth ;
        
        // Score Components Bars
        academicRepScoreContainer = chart.append('g')
                                         .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');     
        
        academicRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .enter()
                                 .append("rect")
                                 .attr('x', x_attr2+xoffset + init_score_display_offset) 
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x2(academicReputationScore(d)); })
                                 .attr('stroke', 'black')
                                 .attr('fill', '#FF8A8A') //red http://www.hitmill.com/html/pastels.html
                                 .on("click", function(d) { console.log(d) ;})
                                 .append("title")
                                 .text(function(d){ return "Academic Reputation Score: " + d3.round(academicReputationScore(d), 1); }) ;
            
        x3 = d3.scale.linear().domain([0, d3.max(sortedData, employerReputationScore)])
                              .range([0, parseInt(weight2*maxOtherBarWidth)]);   
        
        x_attr3 = maxFinalScoreBarWidth+weight1*maxOtherBarWidth ;
        
        employerRepScoreContainer = chart.append('g')
                                         .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');  
                                         
        employerRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .enter()
                                 .append("rect")
                                 .attr('x', x_attr3+xoffset + global_display_offset)
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x3(employerReputationScore(d)); })
                                 .attr('stroke', 'black')
                                 .attr('fill', '#72FE95') //green http://www.hitmill.com/html/pastels.html
                                 .on("click", function(d) { console.log(d) ;})
                                 .append("title")
                                 .text(function(d){ return "Employer Reputation Score: " + d3.round(employerReputationScore(d), 1); }) ;                
        
        x4 = d3.scale.linear()
                     .domain([0, d3.max(sortedData, facultyStudentRatioScore)])
                     .range([0, parseInt(weight3*maxOtherBarWidth)]);       
        
        x_attr4 = maxFinalScoreBarWidth+(weight1+weight2)*maxOtherBarWidth ;
        
        facStuRatioScoreContainer = chart.append('g')
                                         .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');     
        
        facStuRatioScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .enter()
                                 .append("rect")
                                 .attr('x', x_attr4+xoffset + global_display_offset)
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x4(facultyStudentRatioScore(d)); })
                                 .attr('stroke', 'black')
                                 .attr('fill', '#E77AFE') //purple http://www.hitmill.com/html/pastels.html
                                 .on("click", function(d) { console.log(d) ;})
                                 .append("title")
                                 .text(function(d){ return "Faculty-Student Ratio Score: " + d3.round(facultyStudentRatioScore(d), 1); }) ;                
        
        x5 = d3.scale.linear()
                     .domain([0, d3.max(sortedData, internationalFacultyScore)])
                     .range([0, parseInt(weight4*maxOtherBarWidth)]);   
        
        x_attr5 = maxFinalScoreBarWidth+(weight1+weight2+weight3)*maxOtherBarWidth ;
        
        intFacScoreContainer = chart.append('g')
                                    .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');     
                                    
        intFacScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .enter()
                            .append("rect")
                            .attr('x', x_attr5+xoffset + global_display_offset)
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x5(internationalFacultyScore(d)); })
                            .attr('stroke', 'black')
                            .attr('fill', '#FFA04A') //orange http://www.hitmill.com/html/pastels2.html
                            .on("click", function(d) { console.log(d) ;})
                            .append("title")
                            .text(function(d){ return "International Faculty Score: " + d3.round(internationalFacultyScore(d), 1); }) ;               
        
        x6 = d3.scale.linear()
                     .domain([0, d3.max(sortedData, internationalStudentScore)])
                     .range([0, parseInt(weight5*maxOtherBarWidth)]);   
        
        x_attr6 = maxFinalScoreBarWidth+(weight1+weight2+weight3+weight4)*maxOtherBarWidth ;
        
        intStuScoreContainer = chart.append('g')
                                    .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');    
                                    
        intStuScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .enter()
                            .append("rect")
                            .attr('x', x_attr6+xoffset + global_display_offset)
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x6(internationalStudentScore(d)); })
                            .attr('stroke', 'black')
                            .attr('fill', '#D19C67') //brown http://www.hitmill.com/html/pastels2.html
                            .on("click", function(d) { console.log(d) ;})
                            .append("title")
                            .text(function(d){ return "International Student Score: " + d3.round(internationalStudentScore(d), 1); }) ;               

        x7 = d3.scale.linear()
                     .domain([0, d3.max(sortedData, citationsPerFacultyScore)])
                     .range([0, parseInt(weight6*maxOtherBarWidth)]);       
        
        x_attr7 = parseFloat(maxFinalScoreBarWidth+(weight1+weight2+weight3+weight4+weight5)*maxOtherBarWidth) ;
        
        citationScoreContainer = chart.append('g')
                                      .attr('transform', 'translate(' + uniLabel + ',' + (gridLabelHeight + topMargin) + ')');     
                                      
        citationScoreContainer.selectAll("rect")
                              .data(sortedData)
                              .enter()
                              .append("rect")
                              .attr('x', x_attr7+xoffset + global_display_offset)
                              .attr('y', y)
                              .attr('height', yScale.rangeBand())
                              .attr('width', function(d) { return x7(citationsPerFacultyScore(d)); })
                              .attr('stroke', 'black')
                              .attr('fill', '#FFF06A') //yellow http://www.hitmill.com/html/pastels2.html
                              .on("click", function(d) { console.log(d) ;})
                              .append("title")
                              .text(function(d){ return "Faculty Citation Score: " + d3.round(citationsPerFacultyScore(d), 1); }) ;     

        original_scores_button = 0;    
    }
    
    // ----------------------------------- Next function --------------------------------------
        
    function originalWeightedScore() {
    
        if(unscale_button_count==0){
        
            original_scores_button = 1;
            
            origWeights() ;
            
            orig_academicReputationScore = function(d) { return parseFloat(orig_weight1*d['AcademicReputationScore']); } ; 
            //now make function that multiply by weights...use to build rects
            orig_employerReputationScore = function(d) { return parseFloat(orig_weight2*d['EmployerReputationScore']); } ;
            orig_facultyStudentRatioScore = function(d) { return parseFloat(orig_weight3*d['FacultyStudentRatioScore']); } ;
            orig_internationalFacultyScore = function(d) { return parseFloat(orig_weight4*d['InternationalFacultyScore']); } ;
            orig_internationalStudentScore = function(d) { return parseFloat(orig_weight5*d['InternationalStudentsScore']); } ;
            orig_citationsPerFacultyScore = function(d) { return parseFloat(orig_weight6*d['CitationsperFacultyScore']); } ;
        
            //first update the overall scores
            weightedScoreContainer.selectAll("rect")
                                  .data(sortedData)
                                  .transition()
                                  .duration(1500)
                                  .ease("linear")
                                  .attr('y', y)
                                  .attr('height', yScale.rangeBand())
                                  .attr('width', function(d) { return x(overallScore(d)); })
                                  .attr('stroke', 'black')
                                  .attr('fill', '#4985D6') //blue   http://www.hitmill.com/html/pastels.html
                                  .select("title")
                                  .text(function(d){ return "Original Overall Score: " + d3.round(overallScore(d), 1); }) ;
            
            weightedScoreContainer.selectAll("text")                                 
                                  .data(sortedData)
                                  .transition()
                                  .duration(1500)
                                  .ease("elastic")
                                  .attr("x", function(d) { return x(overallScore(d))+xoffset; })
                                  .attr("y", yText)
                                  .attr("dx", -31) // padding for bar value labels
                                  .attr("dy", ".3em") // vertical-align: middle
                                  .attr("text-anchor", "right") // text-align: right
                                  .attr("fill", "white")
                                  .style("font-weight", "bold")
                                  .text(function(d) { return d3.round(overallScore(d), 0); });
            
            x_attr2 = maxFinalScoreBarWidth ;
            
            //now update the component weights and scores
            academicRepScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr2 + xoffset + init_score_display_offset)
                                     .attr('y', y)
                                     .attr('height', yScale.rangeBand())
                                     .attr('width', function(d) { return x2(orig_academicReputationScore(d)); })
                                     .attr('stroke', 'black')
                                     .attr('fill', '#FF8A8A') //red http://www.hitmill.com/html/pastels.html
                                     .select("title")
                                     .text(function(d){ return "Original Academic Reputation Score: " + d3.round(orig_academicReputationScore(d), 1); }) ;
          
            x_attr3 = maxFinalScoreBarWidth+orig_weight1*maxOtherBarWidth ;
          
            employerRepScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr3 + xoffset + global_display_offset)
                                     .attr('y', y)
                                     .attr('height', yScale.rangeBand())
                                     .attr('width', function(d) { return x3(orig_employerReputationScore(d)); })
                                     .attr('stroke', 'black')
                                     .attr('fill', '#72FE95') //green http://www.hitmill.com/html/pastels.html
                                     .select("title")
                                     .text(function(d){ return "Original Employer Reputation Score: " + d3.round(orig_employerReputationScore(d), 1); }) ;                
            
            x_attr4 = maxFinalScoreBarWidth+(orig_weight1+orig_weight2)*maxOtherBarWidth ;
            
            facStuRatioScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr4 + xoffset + global_display_offset)
                                     .attr('y', y)
                                     .attr('height', yScale.rangeBand())
                                     .attr('width', function(d) { return x4(orig_facultyStudentRatioScore(d)); })
                                     .attr('stroke', 'black')
                                     .attr('fill', '#E77AFE') //purple http://www.hitmill.com/html/pastels.html
                                     .select("title")
                                     .text(function(d){ return "Original Faculty-Student Ratio Score: " + d3.round(orig_facultyStudentRatioScore(d), 1); }) ;                

            x_attr5 = maxFinalScoreBarWidth+(orig_weight1+orig_weight2+orig_weight3)*maxOtherBarWidth ;                       

            intFacScoreContainer.selectAll("rect")
                                .data(sortedData)
                                .transition()
                                .duration(1500)
                                .ease("linear")          
                                .attr('x', x_attr5 + xoffset + global_display_offset)
                                .attr('y', y)
                                .attr('height', yScale.rangeBand())
                                .attr('width', function(d) { return x5(orig_internationalFacultyScore(d)); })
                                .attr('stroke', 'black')
                                .attr('fill', '#FFA04A') //orange http://www.hitmill.com/html/pastels2.html
                                .select("title")
                                .text(function(d){ return "Original International Faculty Score: " + d3.round(orig_internationalFacultyScore(d), 1); }) ;               
            
            x_attr6 = maxFinalScoreBarWidth+(orig_weight1+orig_weight2+orig_weight3+orig_weight4)*maxOtherBarWidth ;

            intStuScoreContainer.selectAll("rect")
                                .data(sortedData)
                                .transition()
                                .duration(1500)
                                .ease("linear")
                                .attr('x', x_attr6 + xoffset + global_display_offset)
                                .attr('y', y)
                                .attr('height', yScale.rangeBand())
                                .attr('width', function(d) { return x6(orig_internationalStudentScore(d)); })
                                .attr('stroke', 'black')
                                .attr('fill', '#D19C67') //brown http://www.hitmill.com/html/pastels2.html
                                .select("title")
                                .text(function(d){ return "Original International Student Score: " + d3.round(orig_internationalStudentScore(d), 1); }) ;               

            x_attr7 = parseFloat(maxFinalScoreBarWidth+(orig_weight1+orig_weight2+orig_weight3+orig_weight4+orig_weight5)*maxOtherBarWidth) ;                

            citationScoreContainer.selectAll("rect")
                                  .data(sortedData)
                                  .transition()
                                  .duration(1500)
                                  .ease("linear")
                                  .attr('x',  x_attr7 + xoffset + global_display_offset)
                                  .attr('y', y)
                                  .attr('height', yScale.rangeBand())
                                  .attr('width', function(d) { return x7(orig_citationsPerFacultyScore(d)); })
                                  .attr('stroke', 'black')
                                  .attr('fill', '#FFF06A') //yellow http://www.hitmill.com/html/pastels2.html
                                  .select("title")
                                  .text(function(d){ return "Original Faculty Citation Score: " + d3.round(orig_citationsPerFacultyScore(d), 1); })  ;            

             separate_button_count = 1; 
             // added since this function stacks the scores together; otherwise when you hit 'separate score' afterwards it'll stack beyond what it's supposed to...
            }

    else if(unscale_button_count==1){
        alert("Original score transition is not available once weighted data is unscaled. :-o Hit Refresh to reset (then select Original), or choose Separate or stack options.") ;
            }            
        }

// ----------------------------------- Next function --------------------------------------
  
    function sort_orig() {
    
        if(unscale_button_count==0){
            //reassign variables to the original rankings criteria
            dataset = d3.csv.parse(d3.select('#csv').text());   
            
            sortedData = dataset.sort(function(a, b) {return d3.descending(overallScore(a), overallScore(b));});       
            
            // scales
            yScale = d3.scale.ordinal().domain(d3.range(0, sortedData.length))
                                               .rangeBands([0, sortedData.length * barHeight]);        
            
            x = d3.scale.linear().domain([0, d3.max(sortedData, overallScore)])
                                         .range([0, maxFinalScoreBarWidth]);       
            
            y = function(d, i) { return yScale(i); };        
            
            yText = function(d, i) { return y(d, i) + yScale.rangeBand() / 2; };
                        
            // Rank,School,Country
            barLabel = function(d) { return d['School']+' '+','+' '+d['Country']; } ;         
              
            // update University Names
            labelsContainer = chart.select("g.university-labels-container").selectAll("text")
                                   .data(sortedData)
                                   .transition()
                                   .duration(1500)
                                   .attr('x', xoffset)
                                   .attr('y', yText)
                                   .attr('stroke', 'none')
                                   .attr('fill', 'black')
                                   .attr("dy", ".35em")
                                   .attr('text-anchor', 'end')
                                   .text(barLabel) ;
                               
            originalWeightedScore() ;
            
        }
        
        else if(unscale_button_count==1){
        alert("Original score transition is not available once weighted data is unscaled. :-o Hit Refresh to reset (then select Original), or choose Separate or stack options.") ;
            }       
       }
 
// ----------------------------------- Next function --------------------------------------
    
    unscale_button_count = 0; //initialize, but set to 1 permanently as soon as it's run
    
    function unscale_data() {
    
        if(unscale_button_count==0){
        
            if(original_scores_button==2){
            
                maxOtherBarWidth = (totalWidth - maxFinalScoreBarWidth)/ otherBarsNumber ;
            
                //update x attribute for component scores to make them all the maximum same length irrespective of weighting differences             
                var x2_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_academicReputationScore)])
                                         .range([0, maxOtherBarWidth]); //go from factoring weights here, to setting all linear scale axes ranges to simply 0 to maxOtherBarWidth
                        
                // Score Components Bars       
                x_attr2 = maxFinalScoreBarWidth ;
                
                academicRepScoreContainer.selectAll("rect")
                                         .data(sortedData)
                                         .transition()
                                         .duration(1500)
                                         .ease("linear")
                                         .attr('x', x_attr2+xoffset + init_score_display_offset)
                                         .attr('y', y)
                                         .attr('height', yScale.rangeBand())
                                         .attr('width', function(d) { return x2_unscale(new_academicReputationScore(d)); }) ;
                        
                var x3_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_employerReputationScore)])
                                                  .range([0, maxOtherBarWidth]);

                x_attr3 = maxFinalScoreBarWidth+maxOtherBarWidth ;                                       
                
                employerRepScoreContainer.selectAll("rect")
                                         .data(sortedData)
                                         .transition()
                                         .duration(1500)
                                         .ease("linear")
                                         .attr('x', x_attr3+xoffset + global_display_offset)
                                         .attr('y', y)
                                         .attr('height', yScale.rangeBand())
                                         .attr('width', function(d) { return x3_unscale(new_employerReputationScore(d)); }) ;      
               
                var x4_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_facultyStudentRatioScore)])
                                                  .range([0, maxOtherBarWidth]);      
                
                x_attr4 = maxFinalScoreBarWidth+2*maxOtherBarWidth ;
                
                facStuRatioScoreContainer.selectAll("rect")
                                         .data(sortedData)
                                         .transition()
                                         .duration(1500)
                                         .ease("linear")
                                         .attr('x', x_attr4+xoffset + global_display_offset)
                                         .attr('y', y)
                                         .attr('height', yScale.rangeBand())
                                         .attr('width', function(d) { return x4_unscale(new_facultyStudentRatioScore(d)); }) ;     
                
                x5_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_internationalFacultyScore)])
                                              .range([0, maxOtherBarWidth]);
                
                x_attr5 = maxFinalScoreBarWidth+3*maxOtherBarWidth ;
                    
                intFacScoreContainer.selectAll("rect")
                                    .data(sortedData)
                                    .transition()
                                    .duration(1500)
                                    .ease("linear")
                                    .attr('x', x_attr5+xoffset + global_display_offset)
                                    .attr('y', y)
                                    .attr('height', yScale.rangeBand())
                                    .attr('width', function(d) { return x5_unscale(new_internationalFacultyScore(d)); }) ;   
                
                x6_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_internationalStudentScore)])
                                              .range([0, maxOtherBarWidth]);   
                
                x_attr6 = maxFinalScoreBarWidth+4*maxOtherBarWidth ;
                    
                intStuScoreContainer.selectAll("rect")
                                    .data(sortedData)
                                    .transition()
                                    .duration(1500)
                                    .ease("linear")
                                    .attr('x', x_attr6+xoffset)
                                    .attr('y', y)
                                    .attr('height', yScale.rangeBand())
                                    .attr('width', function(d) { return x6_unscale(new_internationalStudentScore(d)); }) ;   

                x7_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_citationsPerFacultyScore)])
                                              .range([0, maxOtherBarWidth]);  

                x_attr7 = maxFinalScoreBarWidth+5*maxOtherBarWidth ;                             
                                              
                citationScoreContainer.selectAll("rect")
                                      .data(sortedData)
                                      .transition()
                                      .duration(1500)
                                      .ease("linear")
                                      .attr('x', x_attr7+xoffset + global_display_offset)
                                      .attr('y', y)
                                      .attr('height', yScale.rangeBand())
                                      .attr('width', function(d) { return x7_unscale(new_citationsPerFacultyScore(d)); }) ;
                                      
                unscale_button_count = 1;
                
            }
            
            else{
            
                maxOtherBarWidth = (totalWidth - maxFinalScoreBarWidth)/ otherBarsNumber ;
            
                //update x attribute for component scores to make them all the maximum same length irrespective of weighting differences             
                var x2_unscale = d3.scale.linear().domain([0, d3.max(sortedData, academicReputationScore)])
                                         .range([0, maxOtherBarWidth]); //go from factoring weights here, to setting all linear scale axes ranges to simply 0 to maxOtherBarWidth
                        
                // Score Components Bars       
                x_attr2 = maxFinalScoreBarWidth ;
                
                academicRepScoreContainer.selectAll("rect")
                                         .data(sortedData)
                                         .transition()
                                         .duration(1500)
                                         .ease("linear")
                                         .attr('x', x_attr2+xoffset + init_score_display_offset)
                                         .attr('y', y)
                                         .attr('height', yScale.rangeBand())
                                         .attr('width', function(d) { return x2_unscale(academicReputationScore(d)); }) ;
                        
                var x3_unscale = d3.scale.linear().domain([0, d3.max(sortedData, employerReputationScore)])
                                                  .range([0, maxOtherBarWidth]);

                x_attr3 = maxFinalScoreBarWidth+maxOtherBarWidth ;                                       
                
                employerRepScoreContainer.selectAll("rect")
                                         .data(sortedData)
                                         .transition()
                                         .duration(1500)
                                         .ease("linear")
                                         .attr('x', x_attr3+xoffset + global_display_offset)
                                         .attr('y', y)
                                         .attr('height', yScale.rangeBand())
                                         .attr('width', function(d) { return x3_unscale(employerReputationScore(d)); }) ;      
               
                var x4_unscale = d3.scale.linear().domain([0, d3.max(sortedData, facultyStudentRatioScore)])
                                                  .range([0, maxOtherBarWidth]);      
                
                x_attr4 = maxFinalScoreBarWidth+2*maxOtherBarWidth ;
                
                facStuRatioScoreContainer.selectAll("rect")
                                         .data(sortedData)
                                         .transition()
                                         .duration(1500)
                                         .ease("linear")
                                         .attr('x', x_attr4+xoffset + global_display_offset)
                                         .attr('y', y)
                                         .attr('height', yScale.rangeBand())
                                         .attr('width', function(d) { return x4_unscale(facultyStudentRatioScore(d)); }) ;     
                
                x5_unscale = d3.scale.linear().domain([0, d3.max(sortedData, internationalFacultyScore)])
                                              .range([0, maxOtherBarWidth]);
                
                x_attr5 = maxFinalScoreBarWidth+3*maxOtherBarWidth ;
                    
                intFacScoreContainer.selectAll("rect")
                                    .data(sortedData)
                                    .transition()
                                    .duration(1500)
                                    .ease("linear")
                                    .attr('x', x_attr5+xoffset + global_display_offset)
                                    .attr('y', y)
                                    .attr('height', yScale.rangeBand())
                                    .attr('width', function(d) { return x5_unscale(internationalFacultyScore(d)); }) ;   
                
                x6_unscale = d3.scale.linear().domain([0, d3.max(sortedData, internationalStudentScore)])
                                              .range([0, maxOtherBarWidth]);   
                
                x_attr6 = maxFinalScoreBarWidth+4*maxOtherBarWidth ;
                    
                intStuScoreContainer.selectAll("rect")
                                    .data(sortedData)
                                    .transition()
                                    .duration(1500)
                                    .ease("linear")
                                    .attr('x', x_attr6+xoffset + global_display_offset)
                                    .attr('y', y)
                                    .attr('height', yScale.rangeBand())
                                    .attr('width', function(d) { return x6_unscale(internationalStudentScore(d)); }) ;   

                x7_unscale = d3.scale.linear().domain([0, d3.max(sortedData, citationsPerFacultyScore)])
                                              .range([0, maxOtherBarWidth]);  

                x_attr7 = maxFinalScoreBarWidth+5*maxOtherBarWidth ;                             
                                              
                citationScoreContainer.selectAll("rect")
                                      .data(sortedData)
                                      .transition()
                                      .duration(1500)
                                      .ease("linear")
                                      .attr('x', x_attr7+xoffset + global_display_offset)
                                      .attr('y', y)
                                      .attr('height', yScale.rangeBand())
                                      .attr('width', function(d) { return x7_unscale(citationsPerFacultyScore(d)); }) ;
                                      
                unscale_button_count = 1;
                
            }
        }
    }
 
    //this is the function that you call for the button, to avoid garbled interaction where you try to unscale, separated score components (which doesn't work)
    function unscale_scenario(){
        
        if(separate_button_count==1){ 
            unscale_data() ;
        }
        
        else if(separate_button_count==0){
            separateScores() ;
            unscale_data() ; }
        }

 // ----------------------------------- Next function --------------------------------------
 
    separate_button_count = 1; 
    //so it only works once per time. idea for this came from here: http://stackoverflow.com/questions/2294041/disable-the-button-after-clicking-the-button-once
    
    function separateScores() {
    
        if(separate_button_count==1){
        
            addWidth = 360 ;
            totalWidth += addWidth ;
            
            // plus-torial function. source: http://www.codingforums.com/showthread.php?t=257814 , Old Pedant,  04-19-2012, 01:30 AM
            function sum(x){
                var total = 0;
                for ( var n = 1; n <= x; ++n )
                {total += n;}
                return total; }
            
            addBarSpace = addWidth/ sum(otherBarsNumber) ;
            
            // here I need to space out more and more each time ... 1 first time, 2 second time, etc.
            x_attr2 += addBarSpace ;
            x_attr3 += 2*addBarSpace ;
            x_attr4 += 3*addBarSpace ;
            x_attr5 += 4*addBarSpace ;
            x_attr6 += 5*addBarSpace ;
            x_attr7 += 6*addBarSpace ;
            
            academicRepScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr2+xoffset + init_score_display_offset) ;
                                             
            employerRepScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr3+xoffset + global_display_offset) ;
            
            facStuRatioScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr4+xoffset + global_display_offset) ;
                                        
            intFacScoreContainer.selectAll("rect")
                                .data(sortedData)
                                .transition()
                                .duration(1500)
                                .ease("linear")
                                .attr('x', x_attr5+xoffset + global_display_offset) ;
                                        
            intStuScoreContainer.selectAll("rect")
                                .data(sortedData)
                                .transition()
                                .duration(1500)
                                .ease("linear")
                                .attr('x', x_attr6+xoffset + global_display_offset) ;
                                         
            citationScoreContainer.selectAll("rect")
                                  .data(sortedData)
                                  .transition()
                                  .duration(1500)
                                  .ease("linear")
                                  .attr('x', x_attr7+xoffset + global_display_offset) ;
            
            separate_button_count = 0 ;
        }
        
        else if(separate_button_count==0){
        
            totalWidth -= addWidth ;
                       
            // here I need to space out more and more each time ... 1 first time, 2 second time, etc.
            x_attr2 -= addBarSpace ;
            x_attr3 -= 2*addBarSpace ;
            x_attr4 -= 3*addBarSpace ;
            x_attr5 -= 4*addBarSpace ;
            x_attr6 -= 5*addBarSpace ;
            x_attr7 -= 6*addBarSpace ;
            
            academicRepScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr2+xoffset + init_score_display_offset) ;
                                             
            employerRepScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr3+xoffset + global_display_offset) ;  
            
            facStuRatioScoreContainer.selectAll("rect")
                                     .data(sortedData)
                                     .transition()
                                     .duration(1500)
                                     .ease("linear")
                                     .attr('x', x_attr4+xoffset + global_display_offset) ;
                                        
            intFacScoreContainer.selectAll("rect")
                                .data(sortedData)
                                .transition()
                                .duration(1500)
                                .ease("linear")
                                .attr('x', x_attr5+xoffset + global_display_offset) ;
                                        
            intStuScoreContainer.selectAll("rect")
                                .data(sortedData)
                                .transition()
                                .duration(1500)
                                .ease("linear")
                                .attr('x', x_attr6+xoffset + global_display_offset) ;
                                         
            citationScoreContainer.selectAll("rect")
                                  .data(sortedData)
                                  .transition()
                                  .duration(1500)
                                  .ease("linear")
                                  .attr('x', x_attr7+xoffset + global_display_offset) ;    
             
            separate_button_count = 1 ;
        }
    }
    
// ----------------------------------- Next function --------------------------------------
    
    function stackScoresWeighted() {
    
    x2 = d3.scale.linear().domain([0, d3.max(sortedData, academicReputationScore)])
                      .range([0, parseInt(weight1*maxOtherBarWidth)]);   
    
    base_offset =  maxFinalScoreBarWidth + xoffset ;
    
    // Score Components Bars
    academicRepScoreContainer.selectAll("rect")
                             .data(sortedData)
                             .transition()
                             .duration(1500)
                             .ease("linear")
                             .attr('x', base_offset + init_score_display_offset) // start displaying along x axis, right after the max of the overall score
                             .attr('y', y)
                             .attr('height', yScale.rangeBand())
                             .attr('width', function(d) { return x2(academicReputationScore(d)); })
                             .attr('stroke', 'black')
                             .attr('fill', '#FF8A8A') ; //red http://www.hitmill.com/html/pastels.html
        
    x3 = d3.scale.linear().domain([0, d3.max(sortedData, employerReputationScore)])
                          .range([0, parseInt(weight2*maxOtherBarWidth)]);   
                                            
    employerRepScoreContainer.selectAll("rect")
                             .data(sortedData)
                             .transition()
                             .duration(1500)
                             .ease("linear")
                             .attr('x', function(d) {return base_offset + global_display_offset + x3(academicReputationScore(d)) ; })
                             .attr('y', y)
                             .attr('height', yScale.rangeBand())
                             .attr('width', function(d) { return x3(employerReputationScore(d)); })
                             .attr('stroke', 'black')
                             .attr('fill', '#72FE95') ; //green http://www.hitmill.com/html/pastels.html        
    
    x4 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, facultyStudentRatioScore)])
                 .range([0, parseInt(weight3*maxOtherBarWidth)]);       
        
    facStuRatioScoreContainer.selectAll("rect")
                             .data(sortedData)
                             .transition()
                             .duration(1500)
                             .ease("linear")
                             .attr('x', function(d) { return base_offset + global_display_offset + x3(academicReputationScore(d)) 
                                                      + x4(employerReputationScore(d)) ; } )
                             .attr('y', y)
                             .attr('height', yScale.rangeBand())
                             .attr('width', function(d) { return x4(facultyStudentRatioScore(d)); })
                             .attr('stroke', 'black')
                             .attr('fill', '#E77AFE') ; //purple http://www.hitmill.com/html/pastels.html           
    
    x5 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, internationalFacultyScore)])
                 .range([0, parseInt(weight4*maxOtherBarWidth)]);   
                                    
    intFacScoreContainer.selectAll("rect")
                        .data(sortedData)
                        .transition()
                        .duration(1500)
                        .ease("linear")
                        .attr('x', function(d) { return base_offset + global_display_offset + x3(academicReputationScore(d)) 
                                                         + x4(employerReputationScore(d)) + x5(facultyStudentRatioScore(d)) ; } )
                        .attr('y', y)
                        .attr('height', yScale.rangeBand())
                        .attr('width', function(d) { return x5(internationalFacultyScore(d)); })
                        .attr('stroke', 'black')
                        .attr('fill', '#FFA04A') ; //orange http://www.hitmill.com/html/pastels2.html    
    
    x6 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, internationalStudentScore)])
                 .range([0, parseInt(weight5*maxOtherBarWidth)]);   
                                    
    intStuScoreContainer.selectAll("rect")
                        .data(sortedData)
                        .transition()
                        .duration(1500)
                        .ease("linear")
                        .attr('x', function(d) { return base_offset + global_display_offset + x3(academicReputationScore(d)) + x4(employerReputationScore(d))
                                                          + x5(facultyStudentRatioScore(d)) + x6(internationalFacultyScore(d)) ; } )
                        .attr('y', y)
                        .attr('height', yScale.rangeBand())
                        .attr('width', function(d) { return x6(internationalStudentScore(d)); })
                        .attr('stroke', 'black')
                        .attr('fill', '#D19C67') ; //brown http://www.hitmill.com/html/pastels2.html           

    x7 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, citationsPerFacultyScore)])
                 .range([0, parseInt(weight6*maxOtherBarWidth)]);       
                                      
    citationScoreContainer.selectAll("rect")
                          .data(sortedData)
                          .transition()
                          .duration(1500)
                          .ease("linear")
                          .attr('x', function(d) { return base_offset + global_display_offset + x3(academicReputationScore(d)) + x4(employerReputationScore(d)) + x5(facultyStudentRatioScore(d)) 
                                                           + x6(internationalFacultyScore(d)) + x7(internationalStudentScore(d)) ; } )
                          .attr('y', y)
                          .attr('height', yScale.rangeBand())
                          .attr('width', function(d) { return x7(citationsPerFacultyScore(d)); })
                          .attr('stroke', 'black')
                          .attr('fill', '#FFF06A') ; //yellow http://www.hitmill.com/html/pastels2.html     
    }

    function stackScoresOriginal() {
    
        base_offset = maxFinalScoreBarWidth + xoffset ;
        
        //now update the component weights and scores
        academicRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', base_offset + init_score_display_offset)
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x2(orig_academicReputationScore(d)); })
                                 .attr('stroke', 'black')
                                 .attr('fill', '#FF8A8A') //red http://www.hitmill.com/html/pastels.html
                                 .select("title")
                                 .text(function(d){ return "Original Academic Reputation Score: " + d3.round(orig_academicReputationScore(d), 1); }) ;
              
        employerRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', function(d) { return base_offset + global_display_offset + x2(orig_academicReputationScore(d)) ;})
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x3(orig_employerReputationScore(d)); })
                                 .attr('stroke', 'black')
                                 .attr('fill', '#72FE95') //green http://www.hitmill.com/html/pastels.html
                                 .select("title")
                                 .text(function(d){ return "Original Employer Reputation Score: " + d3.round(orig_employerReputationScore(d), 1); }) ;                
                
        facStuRatioScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', function(d) { return base_offset + global_display_offset + x2(orig_academicReputationScore(d)) 
                                                          + x3(orig_employerReputationScore(d)) ;})
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x4(orig_facultyStudentRatioScore(d)); })
                                 .attr('stroke', 'black')
                                 .attr('fill', '#E77AFE') //purple http://www.hitmill.com/html/pastels.html
                                 .select("title")
                                 .text(function(d){ return "Original Faculty-Student Ratio Score: " + d3.round(orig_facultyStudentRatioScore(d), 1); }) ;                

        intFacScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .transition()
                            .duration(1500)
                            .ease("linear")          
                            .attr('x', function(d) { return base_offset + global_display_offset + x2(orig_academicReputationScore(d))+x3(orig_employerReputationScore(d)) 
                                                              + x4(orig_facultyStudentRatioScore(d)) ;})
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x5(orig_internationalFacultyScore(d)); })
                            .attr('stroke', 'black')
                            .attr('fill', '#FFA04A') //orange http://www.hitmill.com/html/pastels2.html
                            .select("title")
                            .text(function(d){ return "Original International Faculty Score: " + d3.round(orig_internationalFacultyScore(d), 1); }) ;               
        
        intStuScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .transition()
                            .duration(1500)
                            .ease("linear")
                            .attr('x', function(d) { return base_offset + global_display_offset + x2(orig_academicReputationScore(d))+x3(orig_employerReputationScore(d)) 
                                                              +x4(orig_facultyStudentRatioScore(d)) + x5(orig_internationalFacultyScore(d)) ;})
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x6(orig_internationalStudentScore(d)); })
                            .attr('stroke', 'black')
                            .attr('fill', '#D19C67') //brown http://www.hitmill.com/html/pastels2.html
                            .select("title")
                            .text(function(d){ return "Original International Student Score: " + d3.round(orig_internationalStudentScore(d), 1); }) ;               

        citationScoreContainer.selectAll("rect")
                              .data(sortedData)
                              .transition()
                              .duration(1500)
                              .ease("linear")
                              .attr('x', function(d) { return base_offset + global_display_offset + x2(orig_academicReputationScore(d))+x3(orig_employerReputationScore(d)) 
                                                               +x4(orig_facultyStudentRatioScore(d))+x5(orig_internationalFacultyScore(d))
                                                               + x6(orig_internationalStudentScore(d)) ;})
                              .attr('y', y)
                              .attr('height', yScale.rangeBand())
                              .attr('width', function(d) { return x7(orig_citationsPerFacultyScore(d)); })
                              .attr('stroke', 'black')
                              .attr('fill', '#FFF06A') //yellow http://www.hitmill.com/html/pastels2.html
                              .select("title")
                              .text(function(d){ return "Original Faculty Citation Score: " + d3.round(orig_citationsPerFacultyScore(d), 1); }) ;             
    }    

    function stackScoresNewWeighted() {
    
    x2 = d3.scale.linear().domain([0, d3.max(sortedData, new_academicReputationScore)])
                      .range([0, parseInt(new_weight1*maxOtherBarWidth)]);   

    base_offset = maxFinalScoreBarWidth + xoffset ; //maxFinalScoreBarWidth is the maximum bar length for overall score
    
    // Score Components Bars
    academicRepScoreContainer.selectAll("rect")
                             .data(sortedData)
                             .transition()
                             .duration(1500)
                             .ease("linear")
                             .attr('x', base_offset + init_score_display_offset) // start displaying along x axis, right after the max of the overall score
                             .attr('y', y)
                             .attr('height', yScale.rangeBand())
                             .attr('width', function(d) { return x2(new_academicReputationScore(d)); })
                             .attr('stroke', 'black')
                             .attr('fill', '#FF8A8A') ; //red http://www.hitmill.com/html/pastels.html
        
    x3 = d3.scale.linear().domain([0, d3.max(sortedData, new_employerReputationScore)])
                          .range([0, parseInt(new_weight2*maxOtherBarWidth)]);   
                                            
    employerRepScoreContainer.selectAll("rect")
                             .data(sortedData)
                             .transition()
                             .duration(1500)
                             .ease("linear")
                             .attr('x', function(d) {return base_offset + global_display_offset + x2(new_academicReputationScore(d)) } )
                             .attr('y', y)
                             .attr('height', yScale.rangeBand())
                             .attr('width', function(d) { return x3(new_employerReputationScore(d)); })
                             .attr('stroke', 'black')
                             .attr('fill', '#72FE95') ; //green http://www.hitmill.com/html/pastels.html         
    
    x4 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, new_facultyStudentRatioScore)])
                 .range([0, parseInt(new_weight3*maxOtherBarWidth)]);       
        
    facStuRatioScoreContainer.selectAll("rect")
                             .data(sortedData)
                             .transition()
                             .duration(1500)
                             .ease("linear")
                             .attr('x', function(d) { return base_offset + global_display_offset + x2(new_academicReputationScore(d))  
                                    + x3(new_employerReputationScore(d)) ; } )
                             .attr('y', y)
                             .attr('height', yScale.rangeBand())
                             .attr('width', function(d) { return x4(new_facultyStudentRatioScore(d)); })
                             .attr('stroke', 'black')
                             .attr('fill', '#E77AFE') ; //purple http://www.hitmill.com/html/pastels.html            
    
    x5 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, new_internationalFacultyScore)])
                 .range([0, parseInt(new_weight4*maxOtherBarWidth)]);   
                                    
    intFacScoreContainer.selectAll("rect")
                        .data(sortedData)
                        .transition()
                        .duration(1500)
                        .ease("linear")
                        .attr('x', function(d) { return base_offset + x2(new_academicReputationScore(d)) + global_display_offset
                                                 + x3(new_employerReputationScore(d)) + x4(new_facultyStudentRatioScore(d)) ; } )
                        .attr('y', y)
                        .attr('height', yScale.rangeBand())
                        .attr('width', function(d) { return x5(new_internationalFacultyScore(d)); })
                        .attr('stroke', 'black')
                        .attr('fill', '#FFA04A') ; //orange http://www.hitmill.com/html/pastels2.html
       
    x6 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, new_internationalStudentScore)])
                 .range([0, parseInt(new_weight5*maxOtherBarWidth)]);   
                                    
    intStuScoreContainer.selectAll("rect")
                        .data(sortedData)
                        .transition()
                        .duration(1500)
                        .ease("linear")
                        .attr('x', function(d) { return base_offset + global_display_offset + x2(new_academicReputationScore(d)) 
                                                          + x3(new_employerReputationScore(d)) + x4(new_facultyStudentRatioScore(d)) 
                                                          + x5(new_internationalFacultyScore(d)) ; } )
                        .attr('y', y)
                        .attr('height', yScale.rangeBand())
                        .attr('width', function(d) { return x6(new_internationalStudentScore(d)); })
                        .attr('stroke', 'black')
                        .attr('fill', '#D19C67') ; //brown http://www.hitmill.com/html/pastels2.html           

    x7 = d3.scale.linear()
                 .domain([0, d3.max(sortedData, new_citationsPerFacultyScore)])
                 .range([0, parseInt(new_weight6*maxOtherBarWidth)]);       
                                      
    citationScoreContainer.selectAll("rect")
                          .data(sortedData)
                          .transition()
                          .duration(1500)
                          .ease("linear")
                          .attr('x', function(d) { return base_offset + global_display_offset + x2(new_academicReputationScore(d)) 
                                                    + x3(new_employerReputationScore(d)) + x4(new_facultyStudentRatioScore(d)) 
                                                    + x5(new_internationalFacultyScore(d)) + x6(new_internationalStudentScore(d)) ; } )
                          .attr('y', y)
                          .attr('height', yScale.rangeBand())
                          .attr('width', function(d) { return x7(new_citationsPerFacultyScore(d)); })
                          .attr('stroke', 'black')
                          .attr('fill', '#FFF06A') ; //yellow http://www.hitmill.com/html/pastels2.html
                          
    stack_score_button = 1 ;
    }
    
    function stackScoresUnscaled() {
            
        var x2_unscale = d3.scale.linear().domain([0, d3.max(sortedData, academicReputationScore)])
                                 .range([0, maxOtherBarWidth]) ;
                
        // Score Components Bars       
        base_offset = maxFinalScoreBarWidth + xoffset ;
        
        academicRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', base_offset + init_score_display_offset)
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x2_unscale(academicReputationScore(d)); }) ;
                
        var x3_unscale = d3.scale.linear().domain([0, d3.max(sortedData, employerReputationScore)])
                                          .range([0, maxOtherBarWidth]) ;
        
        employerRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', function(d) { return base_offset + x2_unscale(academicReputationScore(d)) + global_display_offset ;})
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x3_unscale(employerReputationScore(d)); }) ;         
       
        var x4_unscale = d3.scale.linear().domain([0, d3.max(sortedData, facultyStudentRatioScore)])
                                          .range([0, maxOtherBarWidth]) ;      
                
        facStuRatioScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', function(d) { return (base_offset + x2_unscale(academicReputationScore(d))) + x3_unscale(employerReputationScore(d)) 
                                       + global_display_offset ;})
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x4_unscale(facultyStudentRatioScore(d)); }) ;     
        
        x5_unscale = d3.scale.linear().domain([0, d3.max(sortedData, internationalFacultyScore)])
                                      .range([0, maxOtherBarWidth]) ;
                    
        intFacScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .transition()
                            .duration(1500)
                            .ease("linear")
                            .attr('x', function(d) { return base_offset+x2_unscale(academicReputationScore(d))+x3_unscale(employerReputationScore(d))
                                                     +x4_unscale(facultyStudentRatioScore(d)) + global_display_offset ;})
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x5_unscale(internationalFacultyScore(d)); }) ;    
        
        x6_unscale = d3.scale.linear().domain([0, d3.max(sortedData, internationalStudentScore)])
                                      .range([0, maxOtherBarWidth]) ;   
                    
        intStuScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .transition()
                            .duration(1500)
                            .ease("linear")
                            .attr('x', function(d) { return (base_offset+x2_unscale(academicReputationScore(d))+x3_unscale(employerReputationScore(d)) 
                                               +x4_unscale(facultyStudentRatioScore(d))) + x5_unscale(internationalFacultyScore(d)) + global_display_offset ;})
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x6_unscale(internationalStudentScore(d)); }) ;   

        x7_unscale = d3.scale.linear().domain([0, d3.max(sortedData, citationsPerFacultyScore)])
                                      .range([0, maxOtherBarWidth]) ;  
                                      
        citationScoreContainer.selectAll("rect")
                              .data(sortedData)
                              .transition()
                              .duration(1500)
                              .ease("linear")
                              .attr('x', function(d) { return (base_offset+x2_unscale(academicReputationScore(d))+x3_unscale(employerReputationScore(d)) 
                                                 +x4_unscale(facultyStudentRatioScore(d))+x5_unscale(internationalFacultyScore(d)))
                                                 + x6_unscale(internationalStudentScore(d)) + global_display_offset ;})
                              .attr('y', y)
                              .attr('height', yScale.rangeBand())
                              .attr('width', function(d) { return x7_unscale(citationsPerFacultyScore(d)); }) ;
    }
    
    function stackScoresNewUnscaled() {
    
        var x2_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_academicReputationScore)])
                                 .range([0, maxOtherBarWidth]) ;
                
        // Score Components Bars       
        base_offset = maxFinalScoreBarWidth + xoffset ;
        
        academicRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', base_offset + init_score_display_offset)
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x2_unscale(new_academicReputationScore(d)); }) ;
                
        var x3_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_employerReputationScore)])
                                          .range([0, maxOtherBarWidth]) ;
        
        employerRepScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', function(d) { return base_offset + global_display_offset + x2_unscale(new_academicReputationScore(d)) ;})
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x3_unscale(new_employerReputationScore(d)); }) ;         
       
        var x4_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_facultyStudentRatioScore)])
                                          .range([0, maxOtherBarWidth]) ;      
                
        facStuRatioScoreContainer.selectAll("rect")
                                 .data(sortedData)
                                 .transition()
                                 .duration(1500)
                                 .ease("linear")
                                 .attr('x', function(d) { return base_offset + global_display_offset + x2_unscale(new_academicReputationScore(d)) 
                                                          + x3_unscale(new_employerReputationScore(d)) ;})
                                 .attr('y', y)
                                 .attr('height', yScale.rangeBand())
                                 .attr('width', function(d) { return x4_unscale(new_facultyStudentRatioScore(d)); }) ;     
        
        x5_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_internationalFacultyScore)])
                                      .range([0, maxOtherBarWidth]) ;
                    
        intFacScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .transition()
                            .duration(1500)
                            .ease("linear")
                            .attr('x', function(d) { return base_offset + global_display_offset + x2_unscale(new_academicReputationScore(d))+x3_unscale(new_employerReputationScore(d))
                                                     + x4_unscale(new_facultyStudentRatioScore(d)) ;})
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x5_unscale(new_internationalFacultyScore(d)); }) ;    
        
        x6_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_internationalStudentScore)])
                                      .range([0, maxOtherBarWidth]) ;   
                    
        intStuScoreContainer.selectAll("rect")
                            .data(sortedData)
                            .transition()
                            .duration(1500)
                            .ease("linear")
                            .attr('x', function(d) { return base_offset + global_display_offset + x2_unscale(new_academicReputationScore(d))+x3_unscale(new_employerReputationScore(d)) 
                                               +x4_unscale(new_facultyStudentRatioScore(d)) + x5_unscale(new_internationalFacultyScore(d)) ;})
                            .attr('y', y)
                            .attr('height', yScale.rangeBand())
                            .attr('width', function(d) { return x6_unscale(new_internationalStudentScore(d)); }) ;   

        x7_unscale = d3.scale.linear().domain([0, d3.max(sortedData, new_citationsPerFacultyScore)])
                                      .range([0, maxOtherBarWidth]) ;  
                                      
        citationScoreContainer.selectAll("rect")
                              .data(sortedData)
                              .transition()
                              .duration(1500)
                              .ease("linear")
                              .attr('x', function(d) { return base_offset + global_display_offset + x2_unscale(new_academicReputationScore(d))+x3_unscale(new_employerReputationScore(d)) 
                                                 +x4_unscale(new_facultyStudentRatioScore(d))+x5_unscale(new_internationalFacultyScore(d))
                                                 + x6_unscale(new_internationalStudentScore(d)) ;})
                              .attr('y', y)
                              .attr('height', yScale.rangeBand())
                              .attr('width', function(d) { return x7_unscale(new_citationsPerFacultyScore(d)); }) ;  

        stack_score_button = 1 ;
    }
    
    //choose one or other depending on setup
    function stackChoose() {
        
        if(original_scores_button==0){
        
            if(unscale_button_count==0){
                stackScoresWeighted() ; }
            
            else if(unscale_button_count==1){
                stackScoresUnscaled() ; }
        }
    
        else if(original_scores_button==1){
        
            if(unscale_button_count==0){
                stackScoresOriginal() ; }
            
            else if(unscale_button_count==1){
                stackScoresUnscaled() ; }
        }
        
        else if(original_scores_button==2){
        
            if(unscale_button_count==0){
                stackScoresNewWeighted() ; }   
        
            else if(unscale_button_count==1){
                stackScoresNewUnscaled() ; }
        }
    }
    
// ----------------------------------- Next function --------------------------------------    
    
    function newWeights() {
    
    weightfactor1 = parseInt(document.getElementById("weight1").value) ; //these weight factors come from the slider forms
    weightfactor2 = parseInt(document.getElementById("weight2").value) ;
    weightfactor3 = parseInt(document.getElementById("weight3").value) ;
    weightfactor4 = parseInt(document.getElementById("weight4").value) ;
    weightfactor5 = parseInt(document.getElementById("weight5").value) ;
    weightfactor6 = parseInt(document.getElementById("weight6").value) ;
    
    weight_factor_sum = weightfactor1 + weightfactor2 + weightfactor3 + weightfactor4 + weightfactor5 + weightfactor6 ;
    
    if(weight_factor_sum==0){
        alert("Sum of weights has to be non-zero. Please use sliders to select the weights of the score components relative to each other.") ;
            }       
            
    else if(weight_factor_sum!=0){
    
        if(stack_score_button==0){
        
            //scale so that if you drag all 6 sliders to 100, they're all weighted equally because they're all equal relative to each other
            new_weight1 = weightfactor1 / weight_factor_sum ;
            new_weight2 = weightfactor2 / weight_factor_sum ;
            new_weight3 = weightfactor3 / weight_factor_sum ;
            new_weight4 = weightfactor4 / weight_factor_sum ;
            new_weight5 = weightfactor5 / weight_factor_sum ;
            new_weight6 = weightfactor6 / weight_factor_sum ;
            
            new_academicReputationScore = function(d) { return parseFloat(new_weight1*d['AcademicReputationScore']); } ;
            new_employerReputationScore = function(d) { return parseFloat(new_weight2*d['EmployerReputationScore']); } ;
            new_facultyStudentRatioScore = function(d) { return parseFloat(new_weight3*d['FacultyStudentRatioScore']); } ;
            new_internationalFacultyScore = function(d) { return parseFloat(new_weight4*d['InternationalFacultyScore']); } ;
            new_internationalStudentScore = function(d) { return parseFloat(new_weight5*d['InternationalStudentsScore']); } ;
            new_citationsPerFacultyScore = function(d) { return parseFloat(new_weight6*d['CitationsperFacultyScore']); } ;
            
            new_weightedScore = function(d) { return parseFloat(new_weight1*d['AcademicReputationScore'])+parseFloat(new_weight2*d['EmployerReputationScore'])
                                            +parseFloat(new_weight3*d['FacultyStudentRatioScore'])+parseFloat(new_weight4*d['InternationalFacultyScore'])
                                            +parseFloat(new_weight5*d['InternationalStudentsScore']+parseFloat(new_weight6*d['CitationsperFacultyScore'])); } ;

            //now do like the Original Scores function with the transition   
                if(unscale_button_count==0){
                
                    dataset = d3.csv.parse(d3.select('#csv').text());         
            
                    sortedData = dataset.sort(function(a, b) {return d3.descending(new_weightedScore(a), new_weightedScore(b));});

                    // scales
                    yScale = d3.scale.ordinal().domain(d3.range(0, sortedData.length))
                                                       .rangeBands([0, sortedData.length * barHeight]);        
                    
                    x = d3.scale.linear().domain([0, d3.max(sortedData, overallScore)])
                                                 .range([0, maxFinalScoreBarWidth]);       
                    
                    y = function(d, i) { return yScale(i); };        
                    
                    yText = function(d, i) { return y(d, i) + yScale.rangeBand() / 2; };
                                
                    // Rank,School,Country
                    barLabel = function(d) { return d['School']+' '+','+' '+d['Country']; } ;         
                      
                    labelsContainer = chart.select("g.university-labels-container").selectAll("text")
                                           .data(sortedData)
                                           .transition()
                                           .duration(1500)
                                           .attr('x', xoffset)
                                           .attr('y', yText)
                                           .attr('stroke', 'none')
                                           .attr('fill', 'black')
                                           .attr("dy", ".35em")
                                           .attr('text-anchor', 'end')
                                           .text(barLabel) ;
                
                    //first update the overall scores
                    weightedScoreContainer.selectAll("rect")
                                          .data(sortedData)
                                          .transition()
                                          .duration(1500)
                                          .ease("linear")
                                          .attr('y', y)
                                          .attr('height', yScale.rangeBand())
                                          .attr('width', function(d) { return x(new_weightedScore(d)); })
                                          .attr('stroke', 'black')
                                          .attr('fill', '#4985D6') //blue   http://www.hitmill.com/html/pastels.html
                                          .select("title")
                                          .text(function(d){ return "New Weighted Overall Score: " + d3.round(new_weightedScore(d), 1); }) ;
                    
                    weightedScoreContainer.selectAll("text")                                 
                                          .data(sortedData)
                                          .transition()
                                          .duration(1500)
                                          .ease("elastic")
                                          .attr("x", function(d) { return x(new_weightedScore(d))+xoffset; })
                                          .attr("y", yText)
                                          .attr("dx", -31) // padding for bar value labels
                                          .attr("dy", ".3em") // vertical-align: middle
                                          .attr("text-anchor", "right") // text-align: right
                                          .attr("fill", "white")
                                          .style("font-weight", "bold")
                                          .text(function(d) { return d3.round(new_weightedScore(d), 0); });
                    
                    x_attr2 = maxFinalScoreBarWidth ;
                    
                    //now update the component weights and scores
                    academicRepScoreContainer.selectAll("rect")
                                             .data(sortedData)
                                             .transition()
                                             .duration(1500)
                                             .ease("linear")
                                             .attr('x', x_attr2+xoffset + init_score_display_offset)
                                             .attr('y', y)
                                             .attr('height', yScale.rangeBand())
                                             .attr('width', function(d) { return x2(new_academicReputationScore(d)); })
                                             .attr('stroke', 'black')
                                             .attr('fill', '#FF8A8A') //red http://www.hitmill.com/html/pastels.html
                                             .select("title")
                                             .text(function(d){ return "New Weighted Academic Reputation Score: " + d3.round(new_academicReputationScore(d), 1); }) ;
                  
                    x_attr3 = maxFinalScoreBarWidth+new_weight1*maxOtherBarWidth ;
                  
                    employerRepScoreContainer.selectAll("rect")
                                             .data(sortedData)
                                             .transition()
                                             .duration(1500)
                                             .ease("linear")
                                             .attr('x', x_attr3+xoffset + global_display_offset)
                                             .attr('y', y)
                                             .attr('height', yScale.rangeBand())
                                             .attr('width', function(d) { return x3(new_employerReputationScore(d)); })
                                             .attr('stroke', 'black')
                                             .attr('fill', '#72FE95') //green http://www.hitmill.com/html/pastels.html
                                             .select("title")
                                             .text(function(d){ return "New Weighted Employer Reputation Score: " + d3.round(new_employerReputationScore(d), 1); }) ;                
                    
                    x_attr4 = maxFinalScoreBarWidth+(new_weight1+new_weight2)*maxOtherBarWidth ;
                    
                    facStuRatioScoreContainer.selectAll("rect")
                                             .data(sortedData)
                                             .transition()
                                             .duration(1500)
                                             .ease("linear")
                                             .attr('x', x_attr4+xoffset + global_display_offset)
                                             .attr('y', y)
                                             .attr('height', yScale.rangeBand())
                                             .attr('width', function(d) { return x4(new_facultyStudentRatioScore(d)); })
                                             .attr('stroke', 'black')
                                             .attr('fill', '#E77AFE') //purple http://www.hitmill.com/html/pastels.html
                                             .select("title")
                                             .text(function(d){ return "New Weighted Faculty-Student Ratio Score: " + d3.round(new_facultyStudentRatioScore(d), 1); }) ;                

                    x_attr5 = maxFinalScoreBarWidth+(new_weight1+new_weight2+new_weight3)*maxOtherBarWidth ;                       

                    intFacScoreContainer.selectAll("rect")
                                        .data(sortedData)
                                        .transition()
                                        .duration(1500)
                                        .ease("linear")          
                                        .attr('x', x_attr5+xoffset + global_display_offset)
                                        .attr('y', y)
                                        .attr('height', yScale.rangeBand())
                                        .attr('width', function(d) { return x5(new_internationalFacultyScore(d)); })
                                        .attr('stroke', 'black')
                                        .attr('fill', '#FFA04A') //orange http://www.hitmill.com/html/pastels2.html
                                        .select("title")
                                        .text(function(d){ return "New Weighted International Faculty Score: " + d3.round(new_internationalFacultyScore(d), 1); }) ;               
                    
                    x_attr6 = maxFinalScoreBarWidth+(new_weight1+new_weight2+new_weight3+new_weight4)*maxOtherBarWidth ;

                    intStuScoreContainer.selectAll("rect")
                                        .data(sortedData)
                                        .transition()
                                        .duration(1500)
                                        .ease("linear")
                                        .attr('x', x_attr6+xoffset + global_display_offset)
                                        .attr('y', y)
                                        .attr('height', yScale.rangeBand())
                                        .attr('width', function(d) { return x6(new_internationalStudentScore(d)); })
                                        .attr('stroke', 'black')
                                        .attr('fill', '#D19C67') //brown http://www.hitmill.com/html/pastels2.html
                                        .select("title")
                                        .text(function(d){ return "New Weighted International Student Score: " + d3.round(new_internationalStudentScore(d), 1); }) ;               

                    x_attr7 = parseFloat(maxFinalScoreBarWidth+(new_weight1+new_weight2+new_weight3+new_weight4+new_weight5)*maxOtherBarWidth) ;                

                    citationScoreContainer.selectAll("rect")
                                          .data(sortedData)
                                          .transition()
                                          .duration(1500)
                                          .ease("linear")
                                          .attr('x',  x_attr7+xoffset + global_display_offset)
                                          .attr('y', y)
                                          .attr('height', yScale.rangeBand())
                                          .attr('width', function(d) { return x7(new_citationsPerFacultyScore(d)); })
                                          .attr('stroke', 'black')
                                          .attr('fill', '#FFF06A') //yellow http://www.hitmill.com/html/pastels2.html
                                          .select("title")
                                          .text(function(d){ return "New Weighted Faculty Citation Score: " + d3.round(new_citationsPerFacultyScore(d), 1); })  ;            

                    original_scores_button = 2 //new designation for stackChoose() if you're dealing with New Weighted Scores                      
                }
                }
                
        else if(stack_score_button==1){
            alert("Since you've stacked these scores now, you can't add another score component weight that was 0, to a non-zero value. Hit refresh to do and then re-select.")
            }
            
        }

    if(unscale_button_count==1){
        alert("New Weighted score transition is not available once weighted data is unscaled. :-o Hit Refresh to reset (then select Apply New Weights), or choose Separate or stack options.") ;
            }             
    }
    
// ----------------------------------- End of functions --------------------------------------
    </script>
    </p>
    
<script id="csv" type="text/csv">Rank,School,Country,OverallScore,AcademicReputationScore,EmployerReputationScore,FacultyStudentRatioScore,InternationalFacultyScore,InternationalStudentsScore,CitationsperFacultyScore
1,Massachusetts Institute of Technology (MIT),United States,100,100,100,99.9,86.4,96.5,99.3
2,University of Cambridge,United Kingdom,99.8,100,100,98.3,98.2,96,97
3,Harvard University,United States,99.2,100,100,98.6,90,78.4,100
4,UCL (University College London),United Kingdom,98.7,99.6,95.6,98.4,96.3,99.9,94
5,University of Oxford,United Kingdom,98.6,100,100,100,98,95.8,89.4
6,Imperial College London,United Kingdom,98.3,99.8,100,99.8,99.8,99.6,87.3
7,Yale University,United States,97.5,100,100,100,92.7,63.9,93.3
8,University of Chicago,United States,96.3,99.9,96,95.6,68.9,77.8,96.4
9,Princeton University,United States,95.4,100,88.5,90.7,85.5,63.5,99.8
10,California Institute of Technology (Caltech),United States,95.1,99,51.3,100,96,91.1,100
11,Columbia University,United States,94.7,99.9,100,97.2,16.2,84.9,96.3
12,University of Pennsylvania (UPenn),United States,94.5,98.5,96.2,99.6,55.7,66.8,92.4
13,ETH Zurich (Swiss Federal Institute of Technology),Switzerland,92.8,99.3,94,67,100,98.7,97.2
14,Cornell University,United States,92.1,99.7,96.4,73.9,74.3,67.4,98.8
15,Stanford University,United States,91.7,100,100,72.4,41.9,83.5,100
16,Johns Hopkins University,United States,91.2,94.6,60.2,100,56.8,74.7,99.1
17,University of Michigan,United States,91.2,99.8,96.1,92,50.6,46.5,87.3
18,McGill University,Canada,90.4,98.5,95.1,89.6,86,91.3,69.1
19,University of Toronto,Canada,89.6,99.9,94.3,73.8,96.1,74.8,80.2
20,Duke University,United States,89.5,95.1,81.9,99.7,16.4,44.5,96.9
21,University of Edinburgh,United Kingdom,89.2,99.1,96.8,72.1,89.6,93.8,77.1
22,"University of California, Berkeley (UCB)",United States,88.1,100,100,47,86.1,78.8,97.9
23,University of Hong Kong (HKU),Hong Kong,87.9,99.3,83.8,94.2,100,99.1,50.5
24,Australian National University (ANU),Australia,87.6,99.7,82.5,79.6,100,96.3,64.3
25,"National University of Singapore (NUS)",Singapore,87.2,100,99.4,81.4,100,0,0
26,"King's College London (University of London)",United Kingdom,87.1,92.6,83.8,89.1,93.8,90.6,68.9
27,Northwestern University,United States,85.4,90.7,88.6,82.3,11.9,55.9,97.9
28,University of Bristol,United Kingdom,85.4,91,96,74.8,85.8,75.6,77.3
29,Ecole Polytechnique Fédérale de Lausanne (EPFL),Switzerland,85.1,79.1,75.8,95.1,100,100,79.9
30,The University of Tokyo,Japan,85,100,97.6,89.3,11.1,25.8,73.1
31,"University of California, Los Angeles (UCLA)",United States,84.6,100,96,62.3,1.6,34.4,99.5
32,University of Manchester,United Kingdom,84.2,98.5,100,63.2,85.2,91.4,62.2
33,Hong Kong University of Science & Technology (HKUST),Hong Kong,83.5,92.5,79.7,83.9,100,98.9,54.7
34,École Normale Supérieure de Paris (ENS Paris),France,83.3,90.8,66.9,92.4,26.2,66.2,81.6
35,Kyoto University,Japan,83.3,99.8,81.1,92.6,15.5,21.9,70
36,University of Melbourne,Australia,83.2,99.8,100,46.8,68.9,92.3,74.9
37,Seoul National University (SNU),South Korea,82.2,98.8,83.4,90.7,47.8,61,49.6
38,University of Wisconsin-Madison,United States,81.4,97.1,68.6,85.2,52.4,32.9,68
39,University of Sydney,Australia,81.3,99.3,93.5,50.4,99.7,91.3,58.9
40,Chinese University of Hong Kong (CUHK),Hong Kong,80.1,93.5,72.4,79.8,95.7,83.1,48.7
41,Ecole Polytechnique,France,79.6,73.3,95.9,100,72.4,92.6,57.9
42,Brown University,United States,79.5,81.5,68.8,76.7,32,54.7,97.8
43,New York University (NYU),United States,78.9,97.7,85.3,92.7,23.2,55.7,40.2
44,Peking University,China,78.8,99.7,96.6,82.6,55.7,35,36.8
45,University of British Columbia (UBC),Canada,78.6,99.1,77.8,25.9,61.4,73.2,92.1
46,University of Queensland (UQ),Australia,78.2,95.3,83.3,45.3,95.5,90.5,63.1
47,Nanyang Technological University (NTU),Singapore,77.7,90.4,84.5,85.3,100,97.9,26.7
48,Tsinghua University,China,77.5,98.8,97.6,86,50.6,26.3,32
49,Carnegie Mellon University (CMU),United States,77.4,86,81,55.4,17.7,97.1,86.5
50,Osaka University,Japan,76.8,91.4,69.6,91.7,15.4,20.3,62.1
51,University of Copenhagen,Denmark,76.7,83.5,71.5,99.8,71.8,41.3,48.6
52,University of New South Wales (UNSW),Australia,76.6,95,95.1,39.8,98.8,97.6,52.8
53,Technische Universität München (TUM),Germany,76.4,86.4,91,97.9,48.1,63,34.3
54,University of Glasgow,United Kingdom,76.3,82.4,70.7,60.3,78.5,76.7,78.3
55,Ruprecht-Karls-Universität Heidelberg,Germany,75.5,93.3,42.8,86.5,52.6,65.2,49.7
56,University of Illinois at Urbana-Champaign (UIUC),United States,75.5,97.7,66.7,23.5,56.2,68.8,90
57,"University of North Carolina, Chapel Hill",United States,75.4,80.9,63.2,75.8,30.1,22.2,90.7
58,University of Warwick,United Kingdom,73.9,89.4,100,52.3,90.3,98,37.5
59,University of Washington,United States,73.7,93.6,47.4,46.9,8.8,21,99.5
60,Ludwig-Maximilians-Universität München (LMU),Germany,72.9,97,71.9,33.6,35.7,50,75.6
61,Monash University,Australia,72.2,95.4,96.5,33.6,77,94.5,41.6
62,University of Amsterdam,Netherlands,72.1,89.8,74.6,43.4,54.4,28.8,75.7
63,Korea Advanced Institute of Science & Technology,South Korea,71.8,85.1,51.7,90,36.6,24.1,54
64,Boston University,United States,71.7,72.5,77,73.2,29.4,63.2,74.8
65,Tokyo Institute of Technology,Japan,71.4,76.1,74.5,79.8,14.3,38,70.8
66,University of Sheffield,United Kingdom,71.3,77.7,75.3,58.8,79.6,84.5,60.2
67,Trinity College Dublin,Ireland,71.3,79.6,75,54.1,99.1,80.4,57
68,University of Texas at Austin (UT Austin),United States,71.2,97.4,81,21.1,58.3,27.4,74.7
69,London School of Economics (LSE),United Kingdom,71.1,88,100,58.6,100,100,17.4
70,"University of California, San Diego (UCSD)",United States,70.9,97.5,35.7,31.7,3,23.1,100
71,Lund University,Sweden,70.9,84.7,82.2,41.9,33.3,53.7,76.6
72,University of Nottingham,United Kingdom,70.7,76.6,96.2,55.2,85.3,83.5,51.1
73,University of Southampton,United Kingdom,70.7,73.3,69.8,60,88.2,81,65.9
74,University of Geneva,Switzerland,70.6,65.7,23.7,58.9,100,99.2,97.5
75,Leiden University,Netherlands,70.5,83.8,47.2,33.3,80.4,24.1,98.3
75,Tohoku University,Japan,70.5,76.4,66,96.8,22.3,25.3,54.4
77,University of Birmingham,United Kingdom,70.3,77.3,80.5,50.1,82.6,70.6,64.5
78,University of Helsinki,Finland,70.1,80.9,43.2,86.2,46.2,14.2,62.1
79,University of Western Australia (UWA),Australia,70,77.8,70.9,39.9,99.3,81.7,70.1
80,National Taiwan University (NTU),Taiwan,69.9,97.3,70.3,38,19.4,15.1,69.7
81,Uppsala University,Sweden,69.8,84.3,51.5,42.7,52.7,39.9,85
82,KU Leuven,Belgium,69.7,88.5,70.1,22.7,71,43.5,81.7
83,University of Auckland,New Zealand,69.3,92.8,78.2,27,91.1,91.8,45.5
84,"Washington University in St. Louis",United States,69.1,60.4,22,99.7,3.6,51.9,96.8
85,Utrecht University,Netherlands,68.7,81.4,48.4,45.8,56.1,18.9,88.2
86,Nagoya University,Japan,68.6,69.5,64.2,88,17.7,29,68.6
87,Freie Universität Berlin,Germany,68.6,91,44.6,29.4,43.7,56,80.7
88,Georgia Institute of Technology,United States,68.4,70.7,76.9,19.3,73.7,85.9,99.4
89,Aarhus University,Denmark,68.4,70.5,48.6,69.9,66.5,56,72.5
90,Fudan University,China,68.3,92.5,84.8,42.4,18,49.8,51.4
90,University of Zurich,Switzerland,68.3,76.6,47.7,53.8,100,53.6,68.9
92,Durham University,United Kingdom,67.9,71.1,96.8,45,91,70.4,60
93,University of St Andrews,United Kingdom,67.6,64.7,69.2,60.9,95.3,99.8,61.1
94,University of Leeds,United Kingdom,67.3,81.2,78.9,46.9,77,73.2,46.6
95,City University of Hong Kong,Hong Kong,66.9,73.2,42.8,72.6,100,81.2,45.3
95,Purdue University,United States,66.9,75.8,83.2,34.6,95,74.2,60.9
97,Pohang University of Science & Technology,South Korea,66.8,57.5,37.4,99.2,67.7,13.4,77.4
98,University of Pittsburgh,United States,66.1,53.4,26.3,93.3,68.6,36.4,87.8
99,Erasmus University Rotterdam,Netherlands,65.9,50.5,82.2,58.9,69.7,56,93.6
100,"University of California, Davis (UCD)",United States,65.9,74.6,38,35.4,60,42.5,96.7
101,Pennsylvania State University (Penn State),United States,65.7,77.3,83.3,33.8,17.1,37.3,81.5
102,University of Adelaide,Australia,65.3,73.8,69.5,41,86.9,92.6,54.8
103,Delft University of Technology (TU Delft),Netherlands,65.1,74.8,72.3,39.6,89.9,75.4,55.7
104,University of Minnesota,United States,64.9,82.9,41.8,29.9,7.2,20.5,97.5
105,Ohio State University,United States,64.7,73.7,66.9,35.1,78.6,39.9,74.4
106,Universität Freiburg,Germany,64.4,72.3,21.6,72.4,60,48.1,64.1
107,Maastricht University,Netherlands,64.4,39.1,69.5,78.5,91.8,99.9,79.2
108,University of Alberta,Canada,64.2,71.6,46.6,58.1,90.8,71,52.8
109,University of Groningen,Netherlands,64.2,62.4,43.2,72.4,89.9,79.1,56.6
110,University of York,United Kingdom,63.8,69.2,69.5,48.7,84.5,81.4,52.2
111,University of Oslo,Norway,63.7,69.9,38.1,73.6,30,51.4,62.6
112,Yonsei University,South Korea,63.5,80,65.3,83.7,12.6,38,25.5
113,Dartmouth College,United States,63.5,41.3,67.3,85.6,10.6,49.8,97.3
114,Université de Montréal,Canada,63.5,69.3,37.9,38.5,83.4,84.1,76.2
115,University of Lausanne,Switzerland,62.4,48,26.8,64.3,92.4,87.2,90
116,Lomonosov Moscow State University,Russia,61.8,77.1,71.6,100,6,36.1,5.3
117,"University of Maryland, College Park",United States,61.5,66.4,39.5,60.9,37.7,31.7,73.4
118,"University of California, Santa Barbara (UCSB)",United States,61.3,76.6,27.2,14.5,60.9,29.1,99.8
119,Georg-August-Universität Göttingen,Germany,60.9,70.6,27.3,77.9,42.4,37.6,48.6
120,Rice University,United States,60.8,46.5,26.3,71.5,48.3,71.6,93.1
121,University of Basel,Switzerland,60.5,51.6,31.2,75,100,82.5,60.2
122,Emory University,United States,60.4,38.7,40.4,86.8,18.1,45.7,98.8
123,University of Virginia,United States,60.4,52.4,70.7,66.2,29.3,39.9,75.3
124,University of Liverpool,United Kingdom,60,54.8,66.6,60.6,80.9,73.4,55
125,Shanghai Jiao Tong University (SJTU),China,59.9,80,82.3,42.4,20.6,17.5,43.3
126,Newcastle University,United Kingdom,59.7,45.8,73.8,61.8,82.3,90.5,62.1
127,Université Catholique de Louvain (UCL),Belgium,59.7,70.4,55.8,30.1,74.2,67.8,60.9
128,Kyushu University,Japan,59.6,59.8,67.3,97.7,15.3,22.3,34.6
129,Université Pierre et Marie Curie (UPMC),France,59.6,63.6,27.7,58.7,32.8,67,70.2
130,Humboldt-Universität zu Berlin,Germany,59.4,94.3,37.1,29.2,46.4,47.1,34.2
131,University College Dublin (UCD),Ireland,59.1,59.8,68.6,53.1,92.4,94.6,38.5
132,Technical University of Denmark,Denmark,59,38.6,36.3,97.3,93.1,73.4,57.9
133,University of Otago,New Zealand,58.9,65.8,60.2,31,100,79.8,54
134,University of Southern California (USC),United States,58.8,59.2,45.5,64,20.4,71.4,62.9
135,University of Rochester,United States,58.7,40.1,12.5,100,43.1,78.5,73.7
136,Radboud University Nijmegen,Netherlands,58.5,41.2,39.8,84.9,68.5,33.6,76.9
137,Korea University,South Korea,58.4,76.4,57.4,70.4,23.8,34.7,22.3
138,Hokkaido University,Japan,58.3,56.6,64.7,80.3,13.9,18.1,54.7
139,Universidade de São Paulo,Brazil,58.1,86.8,76.2,37.9,11.3,5.3,33.6
140,Hebrew University of Jerusalem,Israel,58,60.9,25,76.2,26.2,9.6,67.6
141,Karlsruher Institut für Technologie (KIT),Germany,57.9,55.4,76.5,83.1,55.8,58.6,25.6
142,"KTH, Royal Institute of Technology",Sweden,57.7,55.3,63.5,63.7,74.4,91,38.1
143,Cardiff University,United Kingdom,57.5,54.5,64.4,56.1,71.7,71,51.6
144,Eberhard Karls Universität Tübingen,Germany,57.4,57,40.6,80.7,49.9,40.2,46.3
145,University of Bergen,Norway,57,47.7,29.1,59.7,87.9,36.4,81.5
146,Universidad Nacional Autónoma de México (UNAM),Mexico,56.8,89.6,67,56.3,23.2,5,4.9
147,"Queen Mary, University of London (QMUL)",United Kingdom,56.7,57,38.8,67.4,98.5,88.8,33.2
148,University of Ghent,Belgium,56.6,59.3,47.6,77.2,39.8,28.1,43.3
149,University of Bern,Switzerland,56.5,37.5,29.5,77.6,98.4,45.1,76.4
150,Rheinisch-Westfälische Technische Hochschule Aachen,Germany,56.3,66.9,86.7,47,32.1,54.8,32.9
151,Rheinische Friedrich-Wilhelms-Universität Bonn,Germany,56.3,66.7,24.3,72.8,18.2,55.7,41.9
152,McMaster University,Canada,56.1,57.2,35.4,30.5,67.2,54.2,84.7
153,École Normale Supérieure de Lyon (ENS Lyon),France,56.1,55.7,9.9,100,55.1,47.1,35.7
154,University of Cape Town,South Africa,55.7,60.1,65.3,33.7,69.7,63.5,55.8
155,"University of California, Irvine",United States,55.7,61.8,25.8,25.9,33.9,27.8,97.6
156,Universiti Malaya (UM),Malaysia,55.6,61.1,54.4,83.4,77.4,70.2,5.6
157,University of Colorado at Boulder,United States,55.5,48.7,61.4,60,21.3,10.8,78.5
158,Eindhoven University of Technology (TU Eindhoven),Netherlands,54.9,44.1,38.2,99.6,98,28.7,33
159,Hong Kong Polytechnic University,Hong Kong,54.6,60.9,39.2,48.4,99.9,88.2,33.5
160,Universität Wien,Austria,54.6,79,46.1,15.7,70.5,91,33.1
161,Wageningen University,Netherlands,54.6,44.2,27,100,30.8,97.4,36.2
162,University of Aberdeen,United Kingdom,54.3,43.2,49.7,54.9,89,92.5,57.1
163,Lancaster University,United Kingdom,54,55.4,63.8,40,77.3,84,44.1
164,Case Western Reserve University,United States,53.8,27.4,7.1,95.9,25.1,59.4,91
165,Texas A&M University,United States,53.7,64.9,62.3,19.6,20.2,29.6,72.8
166,"Queen's University of Belfast",United Kingdom,53.5,45.4,73,53.5,97.7,78.1,40.2
167,Vanderbilt University,United States,53.5,41.4,35.8,100,13.3,28.7,53.5
168,Nanjing University,China,53.2,70.8,39.4,49.3,41.8,5.8,40.9
169,University of Florida,United States,52.9,60.7,40.9,44.8,11.8,25.7,65.9
170,Zhejiang University,China,52.8,70.5,59.5,29.5,16.3,6.9,55.1
171,Stockholm University,Sweden,52.6,74.2,48.8,36.3,39.2,23.8,35.6
172,Universite Libre de Bruxelles (ULB),Belgium,52.6,55.8,44.2,40.1,89.4,96.3,40.1
173,University of Western Ontario,Canada,52.6,49.3,66.1,28.2,56.2,38,76.9
174,Michigan State University (MSU),United States,52.3,58.1,67.3,28.9,60,43.9,54.1
175,"Queen's University",Canada,52.1,47.8,69.8,28,77.3,30.6,72.3
176,Universitat Autònoma de Barcelona,Spain,52,75.1,30.1,37.1,22.8,31.9,41.2
177,VU University Amsterdam,Netherlands,51.8,65,49.3,44.5,45.2,16.9,41.9
178,University of Bath,United Kingdom,51.8,47,77.5,31.8,88.9,93.5,46.3
179,Sungkyunkwan University,South Korea,51.7,55.1,53.7,84.5,18.9,38.8,20.1
180,"University of Illinois, Chicago (UIC)",United States,51.6,45.4,33.3,53.8,26.2,19.4,82.5
181,Tufts University,United States,51.5,27.4,23.6,60.5,92.9,34.9,96
182,University of Exeter,United Kingdom,51.4,47.2,65.9,32.4,88.3,89,50.2
183,Georgetown University,United States,51.2,48.1,67.9,53.3,47.6,46.8,46.1
183,University of Arizona,United States,51.2,58.3,20.5,39.3,25.3,19.2,75.9
185,University of Leicester,United Kingdom,51.1,37.9,26.4,47.2,84,90.2,73.1
186,University of Science & Technology of China,China,51,57.9,32.1,56.3,9.3,1.6,61.5
187,Universitat de Barcelona (UB),Spain,50.9,77.5,40.4,30.3,8.7,21.8,38.7
188,University of Sussex,United Kingdom,50.6,51.9,25.5,31.6,92.4,85.2,57.9
189,Vrije Universiteit Brussel (VUB),Belgium,50.5,36,59,92.1,50.3,62.8,27.9
190,University College Cork (UCC),Ireland,50.2,51.9,62,42.3,90.5,45.8,37.5
191,University of Waterloo,Canada,50.2,56.1,71.5,20.8,80.1,45.6,48.2
192,National Tsing Hua University,Taiwan,50.2,58.1,27,30.8,53.7,11.9,71.3
193,University of Gothenburg,Sweden,50,51.2,34.9,46.1,46.4,42.5,59.5
194,Università di Bologna (UNIBO),Italy,49.8,80.2,56.4,19.9,12.4,18.4,30.1
195,Pontificia Universidad Católica de Chile,Chile,49.7,71.4,75.9,42,17.8,7.8,16.6
196,University of Antwerp,Belgium,49.5,35.6,32.5,98,64.3,49.7,31
197,King Saud University (KSU),Saudi Arabia,49.4,56.7,22.6,89.1,93.3,19.8,2.6
198,Waseda University,Japan,49.2,73.9,78.8,34.5,32.5,22.7,8.1
199,University of Iowa,United States,49.2,44.3,20.9,53.9,28.3,31.5,75.5
200,Keio University,Japan,49.1,61.4,75.1,59.7,15,7.7,17.5
201,Chulalongkorn University,Thailand,49.1,79,66.3,36.8,24,2.8,8.4
201,Universität Frankfurt am Main,Germany,49.1,57.2,45.5,40,23.1,55.8,46.2
203,University of Tsukuba,Japan,49,50.1,22.3,89.2,14.6,27.2,31.4
204,University of Dundee,United Kingdom,48.9,34.3,23.9,68,82.8,61.8,57.4
205,Universität Hamburg,Germany,48.9,65.4,27.6,54.4,26.1,43.3,25.6
206,Universidad Autónoma de Madrid,Spain,48.8,68.8,47.7,29.2,11.1,17,43.8
207,Technische Universität Berlin,Germany,48.4,63.1,52.4,46.7,35.5,68.6,14.5
208,King Fahd University of Petroleum & Minerals (KFUPM),Saudi Arabia,48.4,43.1,36.9,90,100,56,5.8
209,Tel Aviv University,Israel,48.2,51.4,24.9,14.5,30.8,8.2,99.1
210,Indiana University Bloomington,United States,48.2,58.2,54.1,29.7,14.3,52.7,48.4
211,University of Turku,Finland,48,41,48.9,78.4,26.3,9.5,43.8
212,Indian Institute of Technology Delhi (IITD),India,47.8,53.4,79.4,35.4,1.3,1.6,54.1
213,Sciences Po Paris,France,47.8,35.6,74.8,89.4,52.2,96.3,1.5
214,University of Calgary,Canada,47.8,49.9,40.7,15.2,33,48.3,80.9
215,University of Reading,United Kingdom,47.6,44.1,34.4,50.9,84.3,80.1,38.4
216,Sapienza - Università di Roma,Italy,47.6,78.8,42.9,9.4,5.3,20.7,40.6
217,"Université Paris Sorbonne, Paris 4",France,47.4,83.6,60.7,15.7,6.9,72.2,1.4
218,"Université Paris 11, Sud",France,47.1,41.6,18.3,58.9,41.9,64.9,55.1
218,"Université Paris 1, Panthéon-Sorbonne",France,47.1,76.5,77.7,10.2,32.7,74.9,4.1
220,Technion - Israel Institute of Technology,Israel,47,44.8,24.1,38.6,49.3,6.8,78.5
221,University of Canterbury,New Zealand,47,52,63.4,20.9,100,70.8,33.4
222,Aalto University,Finland,47,40,45.5,95.9,49.3,24.8,15.5
223,Chalmers University of Technology,Sweden,46.7,42.5,61.3,45.1,61.3,50.1,42.3
224,University of Twente,Netherlands,46.5,40.6,30.4,45.7,77.5,74.8,49.7
225,Universidad de Chile,Chile,46.3,75.1,66.1,21,11.1,6.3,20.7
226,Universidad Complutense de Madrid,Spain,46.2,73.6,62.1,27.3,4.8,27.6,15.1
227,Indian Institute of Technology Bombay (IITB),India,46.2,59.5,82.7,28.9,3.2,1.2,38.2
228,Universidade Estadual de Campinas (Unicamp),Brazil,46,65.1,44.9,35.5,26.3,7.2,31.1
229,Universität Stuttgart,Germany,45.4,43.1,50.5,72,37.2,71.3,13.9
230,Universidad de Buenos Aires,Argentina,45.3,81.3,81.9,13.8,0,6.3,5.2
231,University of Miami,United States,45.1,26.4,18,90.9,28.2,35.8,54.7
232,Université de Strasbourg,France,44.8,69.1,21.5,18.6,27.2,67.7,30.4
233,Macquarie University,Australia,44.7,47.4,71.2,13.5,98.5,98.2,28.2
234,Université Paris Diderot - Paris 7,France,44.4,60.3,0,34,40.2,49.4,42.8
235,University of Notre Dame,United States,44.4,35.9,66.8,44.3,10.5,17.1,63.3
236,University of East Anglia (UEA),United Kingdom,44.4,40.2,26.7,41.2,81.4,78.1,44.7
237,Victoria University of Wellington,New Zealand,44.2,52.9,63,18.8,100,78.6,18
238,National Chiao Tung University,Taiwan,43.8,35.4,23,49.6,58.9,47.8,58.2
239,University of Liege,Belgium,43.6,34.8,30.7,46.2,31.2,67.7,59.8
240,University of Ottawa,Canada,43.5,41,23.6,14.3,87.1,36.8,76
241,Yeshiva University,United States,43.1,6.1,4.1,97.4,1.8,48.7,89
242,Loughborough University,United Kingdom,43,37.5,71.8,39.2,88.3,71.9,22.4
243,Dalhousie University,Canada,42.9,35,24.7,33.1,77.9,35.1,68.6
244,Politecnico di Milano,Italy,42.9,56.8,83,18.2,22.2,41.1,23.1
245,Westfälische Wilhelms-Universitat Münster,Germany,42.8,48.6,39.3,53.5,24.6,21,30.1
246,RMIT University,Australia,42.8,46.9,77.2,21.7,100,100,7.7
247,Universität zu Köln,Germany,42.8,51.4,52.9,18.3,29.8,37.3,47.4
248,"Université Grenoble, Joseph Fourier",France,42.7,44.9,24.2,42.3,18.6,46.5,50.9
249,Hanyang University,South Korea,42.5,37.2,31.2,88,24.8,49,13.7
250,American University of Beirut (AUB),Lebanon,42.2,25.8,59.3,65.8,88.6,89.7,17.3
251,Universität Ulm,Germany,42.2,14.4,27.3,96.2,29.7,25.9,56.2
252,Beijing Normal University,China,42,53.9,28.1,47.4,71,15.8,16.7
253,Saint-Petersburg State University,Russia,41.9,43.6,26.7,97.8,3.2,18.5,3.5
254,University of Strathclyde,United Kingdom,41.8,43.1,53.2,35.8,81.3,50.4,25.4
255,Mahidol University,Thailand,41.6,48.6,21.9,82,12.9,7.5,10.8
256,Università degli Studi di Milano,Italy,41.6,55.5,37.8,16.7,12.2,10.7,53.4
256,University of Utah,United States,41.6,23.5,22.3,57.1,28.4,25.5,77
258,Curtin University,Australia,41.5,41.5,65.1,27.3,100,99.8,12.6
259,University of Surrey,United Kingdom,41.4,34.4,48.3,34,92.2,96,30.7
260,"Rutgers (New Brunswick), New Jersey",United States,41.3,49.2,22.6,35.4,27.1,18.4,48
261,Universiti Kebangsaan Malaysia (UKM),Malaysia,41.2,48,26.6,57.6,85.9,45.8,4.2
262,University of Oulu,Finland,41.2,27.9,19.8,91.2,41.1,18,32.3
263,Universität Mannheim,Germany,41.1,25.4,75,12.5,3,40.3,91.9
264,University of Wollongong,Australia,41.1,29.5,73.4,35.7,99.5,82.8,26.5
265,Christian-Albrechts-Universität zu Kiel,Germany,41.1,34.8,24.2,21,56.6,22.3,81
266,Universitat Pompeu Fabra,Spain,41.1,39.6,28.2,51.2,91.6,40.5,25.8
267,Royal Holloway University of London,United Kingdom,41.1,33.9,30.8,36.5,94.8,95.8,35.9
268,University of Newcastle,Australia,41,47.9,39.5,18.4,92.2,68.8,28.7
269,Universität Erlangen-Nürnberg,Germany,41,36.4,21.6,48.7,39.7,23.1,54.7
270,Kyung Hee University,South Korea,40.9,32.4,60.1,82.5,19.2,46.3,8.9
271,Hong Kong Baptist University,Hong Kong,40.9,27,36.1,69.4,88.4,65.2,22.5
271,National Cheng Kung University,Taiwan,40.9,45.5,27.3,42.6,35.9,21.2,40.8
273,University of Indonesia,Indonesia,40.7,52.8,64.4,54.2,28.4,4.2,1.5
274,Vienna University of Technology,Austria,40.6,43.6,52.7,26.6,56.6,89.7,24.1
275,Technische Universität Darmstadt,Germany,40.4,30.4,66.2,48.5,59.9,66.1,26
276,Universität Innsbruck,Austria,40.4,48.1,24.1,15.9,92.2,98.1,28.1
277,Tokyo Medical & Dental University,Japan,40.3,12.3,6.6,100,6.9,19.7,65.1
278,Indian Institute of Technology Kanpur (IITK),India,40.3,44.1,50.6,28.2,1.5,1.1,57.2
279,Universität Konstanz,Germany,40.3,42.4,29.7,48.6,56,39.8,27.3
280,Hiroshima University,Japan,40.3,36.5,21.7,82.4,6.9,16.1,27.4
281,Queensland University of Technology,Australia,40.2,44,65.6,21.9,85,59.8,20.1
282,Simon Fraser University,Canada,40.1,37.3,34.1,11.9,95,64.4,55.1
283,University of Hawaii at Manoa,United States,40.1,25,1,58.5,56.5,51.2,62.5
284,"University of Technology, Sydney",Australia,40,41.6,69.3,21.8,93.4,88.6,12.7
285,National Yang Ming University,Taiwan,40,17.1,25.4,98.5,12.3,11.4,46.4
286,Charles University,Czech Republic,39.9,51.5,36.6,43.1,13.6,47.8,17.6
287,"National University of Ireland, Galway",Ireland,39.9,32.6,43.8,51.5,93.6,59.3,20.4
288,Technische Universität Dresden,Germany,39.7,42.8,39.4,38.7,29.1,33.7,36.8
289,Norwegian University of Science & Technology,Norway,39.7,37.8,29.8,46.4,61,29.6,36.8
290,"University of Massachusetts, Amherst",United States,39.4,48,27.7,26.2,12.2,15,52.3
291,North Carolina State University,United States,39.4,32.4,40.4,27.9,10.5,26.8,72.8
292,Julius-Maximilians-Universität Würzburg,Germany,39.3,26.2,17.1,51,35.6,16.7,69.7
293,University of South Australia,Australia,39.3,38.3,49.9,36.3,100,75.8,12.5
294,"SOAS (Oriental/African Studies), University of London",United Kingdom,39.1,39.1,26.5,49.4,99.8,100,2.9
295,Kobe University,Japan,39.1,38.2,43.6,62.2,8.9,16.5,26.9
296,Rensselaer Polytechnic Institute,United States,39.1,21.4,25.3,34.4,11.5,44.1,89.6
297,Umeå University,Sweden,39,32.8,18.4,51,69,6,48.5
298,Università degli Studi di Padova (UNIPD),Italy,39,53.5,30.3,17,3.7,11.1,50.1
299,University of Victoria,Canada,38.9,30.6,28.9,14.6,91.3,27.5,72.7
300,Stony Brook University,United States,38.9,29.3,3.9,41.9,53.6,54.2,63.2
301,"École des Ponts, ParisTech",France,38.9,17.6,51.3,100,30.9,76.7,4.8
302,University of Eastern Finland,Finland,38.9,19.8,26.5,79.4,31.9,12.3,49.1
303,"University of California, Riverside",United States,38.6,30,12.9,19.1,52.6,35.2,83.6
304,University of Tromsø,Norway,38.5,20.4,5.8,98.6,44.7,31.3,29.4
305,Pontificia Uni. Católica Arg. Santa María (Buenos Aires),Argentina,38.5,48.2,58.8,56.6,0,28.2,1.2
306,Tecnológico de Monterrey (ITESM),Mexico,38.5,41,74.9,52.1,34.8,29.7,2.9
306,"Université Bordeaux 1, Sciences Technologies",France,38.5,32,27.7,52.7,36,54.6,37.4
308,Massey University,New Zealand,38.2,41.8,36.4,32.5,95.5,41,20.6
309,Tulane University,United States,38.2,19.3,21.5,66.2,23.4,33.8,59
309,University of Jyväskylä,Finland,38.2,30,23.1,92.6,31.9,11.3,13.9
311,"University of California, Santa Cruz",United States,38.1,39.1,0,18.2,3.8,4.5,90.1
312,Indian Institute of Technology Madras (IITM),India,38.1,40,73,30.9,2.1,1.2,40.3
313,University at Buffalo SUNY,United States,38.1,29.9,8.2,18.7,9.2,68.3,86.4
314,Università di Pisa,Italy,37.8,52.7,27.4,7.7,12.7,10.4,54.7
315,Université Paris Descartes,France,37.6,32.1,20.3,26.5,7.5,75.9,64.6
316,Johannes Gutenberg Universität Mainz,Germany,37.6,37.4,18,13,34.6,39,70.8
317,Wake Forest University,United States,37.4,5.5,0,99.7,13,15.9,67
318,University of Southern Denmark,Denmark,37.3,25.8,27.5,57.3,49.4,61.2,34.2
319,Iowa State University,United States,37.2,30.2,28.4,29.6,42.4,37.3,60.2
320,Universität Leipzig,Germany,36.7,37,19.9,16.4,14.6,31.9,69.4
321,University of Essex,United Kingdom,36.6,34,16.7,32.2,98.2,99.5,23.3
322,Tokyo University of Science (TUS),Japan,36.3,40.5,27.5,6.7,0,2.5,77.6
323,Taipei Medical University,Taiwan,36.3,28.9,23.5,47.9,30.5,17.5,50.1
324,Dublin City University,Ireland,36,23.8,62.9,41,86.1,64.2,20.4
324,Laval University,Canada,36,32.7,18.6,22.8,23.9,40.2,64.5
326,Universiti Sains Malaysia (USM),Malaysia,35.9,52.5,29.7,28,26.3,53.1,10
327,City University London,United Kingdom,35.9,31.3,54.5,28.2,83.6,97.6,14.3
327,Universidad Austral,Argentina,35.9,26.4,47.3,89.6,9.7,23.8,3.2
329,Boston College,United States,35.8,32,39.1,30.1,91.2,54.1,27.4
330,Arizona State University,United States,35.7,47.2,26.1,13.1,13.2,18.3,48.4
331,Brunel University,United Kingdom,35.6,25.2,47.6,24.1,94.6,87.7,32.4
332,Brandeis University,United States,35.5,20.5,13.4,38,20.8,74.9,66.2
333,"Universidade Federal do Rio de Janeiro",Brazil,35.4,52.4,22.9,40.4,7.8,3.9,15.6
334,King Abdul Aziz University (KAU),Saudi Arabia,35.4,38.6,19.8,57.1,72.7,44.2,1.7
335,Universidad de los Andes,Colombia,35.4,49.9,56.3,26.9,38.3,5.1,9.3
336,Università degli Studi di Roma - Tor Vergata,Italy,35.3,49.7,23,9.3,3.2,13.8,50.3
337,Virginia Polytechnic Institute (Virginia Tech),United States,35.2,37.5,40.2,34.1,25.8,21.9,33.1
338,Ruhr-Universität Bochum,Germany,35.2,33.4,27.4,39.4,40.6,52.1,31
339,George Washington University,United States,35.1,37.1,34.6,36.2,2.5,35.1,36.8
340,Linköping University,Sweden,35,34,36.6,38,38.4,10.6,36.8
341,Ewha Womans University,South Korea,34.9,40.1,29.2,50,21.6,33.8,14.3
342,Flinders University,Australia,34.8,27.7,24.8,67.1,13.8,63.9,17.9
343,Universidad Carlos III de Madrid,Spain,34.6,38.1,44.1,49.1,47.4,27,5.2
344,Université Paris Dauphine,France,34.6,33.6,88.6,22.6,34.3,92.5,5.3
345,Aston University,United Kingdom,34.5,21.3,65.5,24.5,94.4,93.9,23.9
346,Universität Bremen,Germany,34.5,37.8,22.9,43.6,20.5,39.6,24.9
346,Université Claude Bernard Lyon 1,France,34.5,38.7,28.9,27.2,10.1,41.1,38.7
348,University of the Philippines,Philippines,34.5,49.2,63.2,37.3,1,2.7,2.3
349,Indian Institute of Technology Kharagpur (IITKGP),India,34.4,34.6,42.3,32.7,0,1.1,47.1
350,Universitat Politècnica de Catalunya,Spain,34.3,34,21.9,64.7,14.1,43.7,11.8
351,"Université Toulouse III, Paul Sabatier",France,34.2,40,0,54.3,30.9,32.7,18.8
352,Aalborg University,Denmark,34.1,26.6,43.6,42.1,73.6,47.3,21.6
352,Bauman Moscow State Technical University,Russia,34.1,22.2,42.7,99.9,1,8.1,1
354,Hankuk (Korea) University of Foreign Studies,"Korea, South",34.1,19.6,70.3,71,51,36.2,1.7
355,Universität Düsseldorf,Germany,34.1,20,22.7,39.8,8.5,39.3,65.7
356,Washington State University,United States,34,32,28,32.2,72.6,20.3,34.6
357,University of Tasmania,Australia,33.8,27.7,27.4,38.3,51.9,87.8,24.7
358,Universiti Teknologi Malaysia (UTM),Malaysia,33.7,34.1,29.7,58.7,17.1,72.1,2.5
359,Universidad de Navarra,Spain,33.6,22.2,35.3,60.1,27.5,51.1,24.7
360,Universiti Putra Malaysia (UPM),Malaysia,33.6,41.4,29.3,50.4,17.4,40,4.2
361,"Xi'an Jiaotong University",China,33.5,29.9,40.6,69.8,6.9,10.2,11.7
362,James Cook University,Australia,33.5,21.7,23.4,30.4,93.8,50.4,44.2
363,University of the Witwatersrand,South Africa,33.3,37.2,30.6,19.3,74.6,28.9,29.9
364,Universität des Saarlandes,Germany,33.3,22.4,0,34.7,45.6,60.8,58.6
365,Colorado State University,United States,33.2,24.7,36.8,11.9,6.4,9.7,80.7
366,University of Connecticut,United States,33.1,20.5,20.3,31.5,59.3,18.2,62
367,Moscow State Institute of International Relations,Russia,33,16,32.3,98.4,7.3,56.4,1
368,Griffith University,Australia,33,29.6,39.8,23.3,89.9,90.8,15.8
369,L.N. Gumilyov Eurasian National University,Kazakhstan,33,24.3,17.7,99.3,15.3,6.9,1
370,United Arab Emirates University,United Arab Emirates,33,29.1,23.8,35.9,100,87,10.4
371,Novosibirsk State University,Russia,32.9,26.7,22.6,89.1,4.1,16.9,4
372,Universität Regensburg,Germany,32.9,19.1,16.9,60.2,34.6,14.4,43.8
373,Karl-Franzens-Universitaet Graz,Austria,32.9,40.2,18.1,16.2,59,32.8,34.1
374,University of Waikato,New Zealand,32.8,28.8,36.9,27.2,96,81.6,14.9
375,La Trobe University,Australia,32.8,35.6,26.8,21.6,83.9,77.1,15.8
376,Friedrich-Schiller-Universität Jena,Germany,32.6,29.1,17.1,42.6,17.9,18.4,43
377,Ben Gurion University of The Negev,Israel,32.6,30.1,8.6,47.6,67.1,5.7,31
378,"Université Montpellier 2, Sciences et Techniques",France,32.5,26.9,3.1,43.8,17.1,44.2,46.4
379,"Birkbeck College, University of London",United Kingdom,32.5,35.4,15,20.1,92.5,32.3,31.2
380,Bond University,Australia,32.4,11.9,43.5,63.7,86,93.8,6.3
381,Chiba University,Japan,32.1,24.7,9.4,66.1,6.8,18,32.6
381,Universidad Nacional de Colombia,Colombia,32.1,52.3,55.4,19.2,11.4,1.5,4.3
383,University of Kent,United Kingdom,32.1,30.6,21.4,33.1,90.9,72.8,12.7
384,Universität Bielefeld,Germany,32,36.3,28.9,19.5,13.7,23.2,42.7
385,University of Coimbra,Portugal,32,42.2,19.8,22,12.8,44.7,27.6
385,"University of Missouri, Columbia",United States,32,21.5,23.9,46.7,48.3,13.5,41.2
387,University of Georgia,United States,31.9,31.9,31.1,27.3,2.1,10.1,48.2
388,Heriot-watt University,United Kingdom,31.9,17.7,30.4,29.6,94.1,97.2,29.7
389,University of Cincinnati,United States,31.8,16.7,19.6,46.3,20.7,16.1,58.7
390,Al-Farabi Kazakh National University,Kazakhstan,31.7,25.7,20.4,84.4,24.6,14.9,1.1
391,Sogang University,South Korea,31.6,33.3,32.9,53.6,20.2,24.7,8.7
392,"American University in Cairo",Egypt,31.6,30.3,49.4,43.6,97.5,0,3.2
393,University of Saskatchewan,Canada,31.5,21.9,43.4,38.9,26.1,45.4,33.6
393,University of St Gallen (HSG),Switzerland,31.5,17.2,85.8,18,99.5,98,11.2
395,University of Tampere,Finland,31.4,27.1,27.2,53.3,21.5,8.6,27
396,National Taiwan University of Science & Technology,Taiwan,31.4,31.1,22.6,54.9,13.2,22.1,18.1
396,"Université Lille 1, Sciences et Technologie",France,31.4,28.3,31.5,35.6,30.6,79.6,19.8
398,University of Warsaw,Poland,31.4,45.4,39.4,32,8.3,7.1,8.8
399,Universität Bayreuth,Germany,31.3,0,0,51.3,41,20.5,28.8
400,University of New Mexico,United States,31.3,23.7,13.6,44.3,8,12.4,51.4 
</script>

<script> startWeights(); makeChart();</script>
        
</body>

<text> Current as of January 20, 2014. Email contact: conormyhrvold at fas . harvard.edu </text>
</html>
